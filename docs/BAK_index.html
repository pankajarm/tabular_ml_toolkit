---

title: Tabular ML Toolkit


keywords: fastai
sidebar: home_sidebar

summary: "A super fast helper library to jumpstart your machine learning project based on tabular or structured data."
description: "A super fast helper library to jumpstart your machine learning project based on tabular or structured data."
nb_path: "BAK_index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: BAK_index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pip install -U tabular_ml_toolkit</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-use">How to use<a class="anchor-link" href="#How-to-use"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Start with your favorite model and then just simply create MLPipeline with one API.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>For example, Here we are using RandomForestRegressor from Scikit-Learn, on  <a href="https://www.kaggle.com/estrotococo/home-data-for-ml-course">Melbourne Home Sale price data</a></em></p>
<p><em>No need to install scikit-learn as it comes preinstall with Tabular_ML_Toolkit</em></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">tabular_ml_toolkit.tmlt</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># just to measure fit time</span>
<span class="kn">import</span> <span class="nn">time</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">DIRECTORY_PATH</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/psmathur/tabular_ml_toolkit/master/input/home_data/&quot;</span>
<span class="n">TRAIN_FILE</span> <span class="o">=</span> <span class="s2">&quot;train.csv&quot;</span>
<span class="n">TEST_FILE</span> <span class="o">=</span> <span class="s2">&quot;test.csv&quot;</span>
<span class="n">SAMPLE_SUB_FILE</span> <span class="o">=</span> <span class="s2">&quot;sample_submission.csv&quot;</span>
<span class="c1">#Make sure to create this output directory next to this notebook</span>
<span class="n">OUTPUT_PATH</span> <span class="o">=</span> <span class="s2">&quot;tutorial_output/&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xgb_model</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># createm ml pipeline for scikit-learn model</span>
<span class="n">tmlt</span> <span class="o">=</span> <span class="n">TMLT</span><span class="p">()</span><span class="o">.</span><span class="n">prepare_data_for_training</span><span class="p">(</span>
    <span class="n">train_file_path</span><span class="o">=</span> <span class="n">DIRECTORY_PATH</span><span class="o">+</span><span class="n">TRAIN_FILE</span><span class="p">,</span>
    <span class="n">test_file_path</span><span class="o">=</span> <span class="n">DIRECTORY_PATH</span><span class="o">+</span><span class="n">TEST_FILE</span><span class="p">,</span>
    <span class="n">idx_col</span><span class="o">=</span><span class="s2">&quot;Id&quot;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;SalePrice&quot;</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">xgb_model</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
    <span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;regression&quot;</span><span class="p">)</span>

<span class="c1"># visualize scikit-pipeline</span>
<span class="c1"># tmlt.spl</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-20 21:20:06,045 INFO 12 cores found, parallel processing is enabled!
2021-11-20 21:20:06,576 INFO DataFrame Memory usage decreased to 0.58 Mb (35.5% reduction)
2021-11-20 21:20:06,980 INFO DataFrame Memory usage decreased to 0.58 Mb (34.8% reduction)
2021-11-20 21:20:07,008 INFO Both Numerical &amp; Categorical columns found, Preprocessing will done accordingly!
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">study</span> <span class="o">=</span> <span class="n">tmlt</span><span class="o">.</span><span class="n">do_xgb_optuna_optimization</span><span class="p">(</span><span class="n">xgb_eval_metric</span><span class="o">=</span><span class="s2">&quot;rmse&quot;</span><span class="p">,</span>
                                        <span class="n">kfold_metrics</span><span class="o">=</span><span class="n">mean_absolute_error</span><span class="p">,</span>
                                        <span class="n">output_dir_path</span><span class="o">=</span><span class="n">OUTPUT_PATH</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">study</span><span class="o">.</span><span class="n">best_trial</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-20 21:20:07,013 INFO direction is: minimize
<span class="ansi-green-fg">[I 2021-11-20 21:20:07,129]</span> A new study created in RDB with name: tmlt_autoxgb
/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/sklearn/model_selection/_split.py:676: UserWarning: The least populated class in y has only 1 members, which is less than n_splits=5.
  warnings.warn(
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[21:20:07] WARNING: /Users/runner/miniforge3/conda-bld/xgboost-split_1634712680264/work/src/learner.cc:576: 
Parameters: { &#34;colsample_bytree&#34;, &#34;max_depth&#34;, &#34;subsample&#34;, &#34;tree_method&#34; } might not be used.

  This could be a false alarm, with some parameters getting used by language bindings but
  then being mistakenly passed down to XGBoost core, or some parameter actually being used
  but getting flagged wrongly here. Please open an issue if you find any such cases.


</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-20 21:20:11,393 INFO fold: 1 , mean_absolute_error: 35790.80912885274
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[21:20:11] WARNING: /Users/runner/miniforge3/conda-bld/xgboost-split_1634712680264/work/src/learner.cc:576: 
Parameters: { &#34;colsample_bytree&#34;, &#34;max_depth&#34;, &#34;subsample&#34;, &#34;tree_method&#34; } might not be used.

  This could be a false alarm, with some parameters getting used by language bindings but
  then being mistakenly passed down to XGBoost core, or some parameter actually being used
  but getting flagged wrongly here. Please open an issue if you find any such cases.


</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-20 21:20:17,146 INFO fold: 2 , mean_absolute_error: 33405.666309931505
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[21:20:17] WARNING: /Users/runner/miniforge3/conda-bld/xgboost-split_1634712680264/work/src/learner.cc:576: 
Parameters: { &#34;colsample_bytree&#34;, &#34;max_depth&#34;, &#34;subsample&#34;, &#34;tree_method&#34; } might not be used.

  This could be a false alarm, with some parameters getting used by language bindings but
  then being mistakenly passed down to XGBoost core, or some parameter actually being used
  but getting flagged wrongly here. Please open an issue if you find any such cases.


</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-20 21:20:22,751 INFO fold: 3 , mean_absolute_error: 39933.20020869007
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[21:20:22] WARNING: /Users/runner/miniforge3/conda-bld/xgboost-split_1634712680264/work/src/learner.cc:576: 
Parameters: { &#34;colsample_bytree&#34;, &#34;max_depth&#34;, &#34;subsample&#34;, &#34;tree_method&#34; } might not be used.

  This could be a false alarm, with some parameters getting used by language bindings but
  then being mistakenly passed down to XGBoost core, or some parameter actually being used
  but getting flagged wrongly here. Please open an issue if you find any such cases.


</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-20 21:20:27,901 INFO fold: 4 , mean_absolute_error: 35007.23145869007
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[21:20:27] WARNING: /Users/runner/miniforge3/conda-bld/xgboost-split_1634712680264/work/src/learner.cc:576: 
Parameters: { &#34;colsample_bytree&#34;, &#34;max_depth&#34;, &#34;subsample&#34;, &#34;tree_method&#34; } might not be used.

  This could be a false alarm, with some parameters getting used by language bindings but
  then being mistakenly passed down to XGBoost core, or some parameter actually being used
  but getting flagged wrongly here. Please open an issue if you find any such cases.


</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-20 21:20:33,069 INFO fold: 5 , mean_absolute_error: 37255.71524507705
2021-11-20 21:20:33,070 INFO  mean metrics score: 36278.524470248296
<span class="ansi-green-fg">[I 2021-11-20 21:20:33,109]</span> Trial 0 finished with value: 36278.524470248296 and parameters: {&#39;learning_rate&#39;: 0.06837917669134744, &#39;reg_lambda&#39;: 10.464291360599324, &#39;reg_alpha&#39;: 3.881790940186402e-08, &#39;subsample&#39;: 0.6307472664806286, &#39;colsample_bytree&#39;: 0.7793929777473942, &#39;max_depth&#39;: 7, &#39;early_stopping_rounds&#39;: 403, &#39;n_estimators&#39;: 15000, &#39;tree_method&#39;: &#39;approx&#39;, &#39;booster&#39;: &#39;gblinear&#39;}. Best is trial 0 with value: 36278.524470248296.
/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/sklearn/model_selection/_split.py:676: UserWarning: The least populated class in y has only 1 members, which is less than n_splits=5.
  warnings.warn(
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[21:20:33] WARNING: /Users/runner/miniforge3/conda-bld/xgboost-split_1634712680264/work/src/learner.cc:576: 
Parameters: { &#34;colsample_bytree&#34;, &#34;max_depth&#34;, &#34;subsample&#34;, &#34;tree_method&#34; } might not be used.

  This could be a false alarm, with some parameters getting used by language bindings but
  then being mistakenly passed down to XGBoost core, or some parameter actually being used
  but getting flagged wrongly here. Please open an issue if you find any such cases.


</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-20 21:20:35,475 INFO fold: 1 , mean_absolute_error: 19432.099475599316
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[21:20:35] WARNING: /Users/runner/miniforge3/conda-bld/xgboost-split_1634712680264/work/src/learner.cc:576: 
Parameters: { &#34;colsample_bytree&#34;, &#34;max_depth&#34;, &#34;subsample&#34;, &#34;tree_method&#34; } might not be used.

  This could be a false alarm, with some parameters getting used by language bindings but
  then being mistakenly passed down to XGBoost core, or some parameter actually being used
  but getting flagged wrongly here. Please open an issue if you find any such cases.


</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-20 21:20:37,915 INFO fold: 2 , mean_absolute_error: 17706.260675299658
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[21:20:37] WARNING: /Users/runner/miniforge3/conda-bld/xgboost-split_1634712680264/work/src/learner.cc:576: 
Parameters: { &#34;colsample_bytree&#34;, &#34;max_depth&#34;, &#34;subsample&#34;, &#34;tree_method&#34; } might not be used.

  This could be a false alarm, with some parameters getting used by language bindings but
  then being mistakenly passed down to XGBoost core, or some parameter actually being used
  but getting flagged wrongly here. Please open an issue if you find any such cases.


</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-20 21:20:40,171 INFO fold: 3 , mean_absolute_error: 17637.29025979238
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[21:20:40] WARNING: /Users/runner/miniforge3/conda-bld/xgboost-split_1634712680264/work/src/learner.cc:576: 
Parameters: { &#34;colsample_bytree&#34;, &#34;max_depth&#34;, &#34;subsample&#34;, &#34;tree_method&#34; } might not be used.

  This could be a false alarm, with some parameters getting used by language bindings but
  then being mistakenly passed down to XGBoost core, or some parameter actually being used
  but getting flagged wrongly here. Please open an issue if you find any such cases.


</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-20 21:20:42,608 INFO fold: 4 , mean_absolute_error: 16144.116933326199
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[21:20:42] WARNING: /Users/runner/miniforge3/conda-bld/xgboost-split_1634712680264/work/src/learner.cc:576: 
Parameters: { &#34;colsample_bytree&#34;, &#34;max_depth&#34;, &#34;subsample&#34;, &#34;tree_method&#34; } might not be used.

  This could be a false alarm, with some parameters getting used by language bindings but
  then being mistakenly passed down to XGBoost core, or some parameter actually being used
  but getting flagged wrongly here. Please open an issue if you find any such cases.


</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-20 21:20:45,684 INFO fold: 5 , mean_absolute_error: 17603.451713666524
2021-11-20 21:20:45,685 INFO  mean metrics score: 17704.643811536815
<span class="ansi-green-fg">[I 2021-11-20 21:20:45,710]</span> Trial 1 finished with value: 17704.643811536815 and parameters: {&#39;learning_rate&#39;: 0.013251610183817672, &#39;reg_lambda&#39;: 0.05070997103744175, &#39;reg_alpha&#39;: 6.5596377189764485, &#39;subsample&#39;: 0.24997325724596772, &#39;colsample_bytree&#39;: 0.26866824835445197, &#39;max_depth&#39;: 1, &#39;early_stopping_rounds&#39;: 143, &#39;n_estimators&#39;: 7000, &#39;tree_method&#39;: &#39;exact&#39;, &#39;booster&#39;: &#39;gblinear&#39;}. Best is trial 1 with value: 17704.643811536815.
/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/sklearn/model_selection/_split.py:676: UserWarning: The least populated class in y has only 1 members, which is less than n_splits=5.
  warnings.warn(
2021-11-20 21:21:39,657 INFO fold: 1 , mean_absolute_error: 18901.152236729453
2021-11-20 21:22:35,102 INFO fold: 2 , mean_absolute_error: 14733.510019798801
2021-11-20 21:23:27,829 INFO fold: 3 , mean_absolute_error: 14491.222201412671
2021-11-20 21:24:22,652 INFO fold: 4 , mean_absolute_error: 13826.06889447774
2021-11-20 21:25:17,423 INFO fold: 5 , mean_absolute_error: 15390.086740154109
2021-11-20 21:25:17,424 INFO  mean metrics score: 15468.408018514552
<span class="ansi-green-fg">[I 2021-11-20 21:25:17,451]</span> Trial 2 finished with value: 15468.408018514552 and parameters: {&#39;learning_rate&#39;: 0.011129207646131652, &#39;reg_lambda&#39;: 0.30050997361951176, &#39;reg_alpha&#39;: 52.967728527588584, &#39;subsample&#39;: 0.5258942705414594, &#39;colsample_bytree&#39;: 0.936441228462284, &#39;max_depth&#39;: 9, &#39;early_stopping_rounds&#39;: 323, &#39;n_estimators&#39;: 20000, &#39;tree_method&#39;: &#39;hist&#39;, &#39;booster&#39;: &#39;gbtree&#39;, &#39;gamma&#39;: 0.00016954628965916405, &#39;grow_policy&#39;: &#39;depthwise&#39;}. Best is trial 2 with value: 15468.408018514552.
/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/sklearn/model_selection/_split.py:676: UserWarning: The least populated class in y has only 1 members, which is less than n_splits=5.
  warnings.warn(
2021-11-20 21:25:25,968 INFO fold: 1 , mean_absolute_error: 19026.759765625
2021-11-20 21:25:36,473 INFO fold: 2 , mean_absolute_error: 15440.874344499143
2021-11-20 21:25:46,801 INFO fold: 3 , mean_absolute_error: 15666.027357127568
2021-11-20 21:25:55,522 INFO fold: 4 , mean_absolute_error: 14021.183526862158
2021-11-20 21:26:04,050 INFO fold: 5 , mean_absolute_error: 16386.93759364298
2021-11-20 21:26:04,050 INFO  mean metrics score: 16108.356517551369
<span class="ansi-green-fg">[I 2021-11-20 21:26:04,071]</span> Trial 3 finished with value: 16108.356517551369 and parameters: {&#39;learning_rate&#39;: 0.0503226358564826, &#39;reg_lambda&#39;: 1.1229913666738015e-06, &#39;reg_alpha&#39;: 71.68561238121049, &#39;subsample&#39;: 0.4160637987544571, &#39;colsample_bytree&#39;: 0.6832322539639468, &#39;max_depth&#39;: 2, &#39;early_stopping_rounds&#39;: 146, &#39;n_estimators&#39;: 15000, &#39;tree_method&#39;: &#39;hist&#39;, &#39;booster&#39;: &#39;gbtree&#39;, &#39;gamma&#39;: 4.335629380031712e-05, &#39;grow_policy&#39;: &#39;depthwise&#39;}. Best is trial 2 with value: 15468.408018514552.
/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/sklearn/model_selection/_split.py:676: UserWarning: The least populated class in y has only 1 members, which is less than n_splits=5.
  warnings.warn(
2021-11-20 21:26:41,623 INFO fold: 1 , mean_absolute_error: 19008.612973565923
2021-11-20 21:27:20,727 INFO fold: 2 , mean_absolute_error: 15020.97230843322
2021-11-20 21:27:58,353 INFO fold: 3 , mean_absolute_error: 14508.753290881848
2021-11-20 21:28:36,371 INFO fold: 4 , mean_absolute_error: 14030.747806078767
2021-11-20 21:29:12,872 INFO fold: 5 , mean_absolute_error: 14856.748876284246
2021-11-20 21:29:12,873 INFO  mean metrics score: 15485.1670510488
<span class="ansi-green-fg">[I 2021-11-20 21:29:12,902]</span> Trial 4 finished with value: 15485.1670510488 and parameters: {&#39;learning_rate&#39;: 0.010816847804170051, &#39;reg_lambda&#39;: 5.4599775001054915e-06, &#39;reg_alpha&#39;: 4.6438120639609614e-08, &#39;subsample&#39;: 0.6130640487597314, &#39;colsample_bytree&#39;: 0.8642728092544076, &#39;max_depth&#39;: 6, &#39;early_stopping_rounds&#39;: 168, &#39;n_estimators&#39;: 15000, &#39;tree_method&#39;: &#39;hist&#39;, &#39;booster&#39;: &#39;gbtree&#39;, &#39;gamma&#39;: 1.9097138154879084e-05, &#39;grow_policy&#39;: &#39;depthwise&#39;}. Best is trial 2 with value: 15468.408018514552.
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>FrozenTrial(number=2, values=[15468.408018514552], datetime_start=datetime.datetime(2021, 11, 20, 21, 20, 45, 716981), datetime_complete=datetime.datetime(2021, 11, 20, 21, 25, 17, 425720), params={&#39;booster&#39;: &#39;gbtree&#39;, &#39;colsample_bytree&#39;: 0.936441228462284, &#39;early_stopping_rounds&#39;: 323, &#39;gamma&#39;: 0.00016954628965916405, &#39;grow_policy&#39;: &#39;depthwise&#39;, &#39;learning_rate&#39;: 0.011129207646131652, &#39;max_depth&#39;: 9, &#39;n_estimators&#39;: 20000, &#39;reg_alpha&#39;: 52.967728527588584, &#39;reg_lambda&#39;: 0.30050997361951176, &#39;subsample&#39;: 0.5258942705414594, &#39;tree_method&#39;: &#39;hist&#39;}, distributions={&#39;booster&#39;: CategoricalDistribution(choices=(&#39;gbtree&#39;, &#39;gblinear&#39;)), &#39;colsample_bytree&#39;: UniformDistribution(high=1.0, low=0.1), &#39;early_stopping_rounds&#39;: IntUniformDistribution(high=500, low=100, step=1), &#39;gamma&#39;: LogUniformDistribution(high=1.0, low=1e-08), &#39;grow_policy&#39;: CategoricalDistribution(choices=(&#39;depthwise&#39;, &#39;lossguide&#39;)), &#39;learning_rate&#39;: LogUniformDistribution(high=0.25, low=0.01), &#39;max_depth&#39;: IntUniformDistribution(high=9, low=1, step=1), &#39;n_estimators&#39;: CategoricalDistribution(choices=(7000, 15000, 20000)), &#39;reg_alpha&#39;: LogUniformDistribution(high=100.0, low=1e-08), &#39;reg_lambda&#39;: LogUniformDistribution(high=100.0, low=1e-08), &#39;subsample&#39;: UniformDistribution(high=1.0, low=0.1), &#39;tree_method&#39;: CategoricalDistribution(choices=(&#39;exact&#39;, &#39;approx&#39;, &#39;hist&#39;))}, user_attrs={}, system_attrs={}, intermediate_values={}, trial_id=3, state=TrialState.COMPLETE, value=None)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Update-XGB-Model-with-best-params">Update XGB Model with best params<a class="anchor-link" href="#Update-XGB-Model-with-best-params"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xgb_params</span> <span class="o">=</span>  <span class="n">study</span><span class="o">.</span><span class="n">best_trial</span><span class="o">.</span><span class="n">params</span>
<span class="n">xgb_model</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="o">**</span><span class="n">xgb_params</span><span class="p">)</span>
<span class="n">tmlt</span><span class="o">.</span><span class="n">update_model</span><span class="p">(</span><span class="n">xgb_model</span><span class="p">)</span>
<span class="n">tmlt</span><span class="o">.</span><span class="n">spl</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<style>#sk-7ac9813a-95f2-488d-b083-60033d6b103f {color: black;background-color: white;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f pre{padding: 0;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f div.sk-toggleable {background-color: white;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f div.sk-estimator:hover {background-color: #d4ebff;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f div.sk-item {z-index: 1;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f div.sk-parallel::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f div.sk-parallel-item {display: flex;flex-direction: column;position: relative;background-color: white;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f div.sk-parallel-item:only-child::after {width: 0;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;position: relative;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f div.sk-label label {font-family: monospace;font-weight: bold;background-color: white;display: inline-block;line-height: 1.2em;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f div.sk-label-container {position: relative;z-index: 2;text-align: center;}#sk-7ac9813a-95f2-488d-b083-60033d6b103f div.sk-container {display: inline-block;position: relative;}</style><div id="sk-7ac9813a-95f2-488d-b083-60033d6b103f" class"sk-top-container"><div class="sk-container"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="acac6412-d6f6-4989-a460-f561f2931932" type="checkbox" ><label class="sk-toggleable__label" for="acac6412-d6f6-4989-a460-f561f2931932">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[('preprocessor',
                 ColumnTransformer(transformers=[('num_cols',
                                                  Pipeline(steps=[('imputer',
                                                                   SimpleImputer(strategy='constant')),
                                                                  ('scaler',
                                                                   StandardScaler())]),
                                                  ['MSSubClass', 'LotFrontage',
                                                   'LotArea', 'OverallQual',
                                                   'OverallCond', 'YearBuilt',
                                                   'YearRemodAdd', 'MasVnrArea',
                                                   'BsmtFinSF1', 'BsmtFinSF2',
                                                   'BsmtUnfSF', 'TotalBsmtSF',
                                                   '1stFlrSF', '2ndFlrSF',
                                                   '...
                              max_delta_step=None, max_depth=9,
                              min_child_weight=None, missing=nan,
                              monotone_constraints=None, n_estimators=20000,
                              n_jobs=None, num_parallel_tree=None,
                              predictor=None, random_state=None,
                              reg_alpha=52.967728527588584,
                              reg_lambda=0.30050997361951176,
                              scale_pos_weight=None,
                              subsample=0.5258942705414594, tree_method='hist',
                              validate_parameters=None, verbosity=None))])</pre></div></div></div><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="6c5d8d3d-170e-42e8-978e-024dcbfab38f" type="checkbox" ><label class="sk-toggleable__label" for="6c5d8d3d-170e-42e8-978e-024dcbfab38f">preprocessor: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(transformers=[('num_cols',
                                 Pipeline(steps=[('imputer',
                                                  SimpleImputer(strategy='constant')),
                                                 ('scaler', StandardScaler())]),
                                 ['MSSubClass', 'LotFrontage', 'LotArea',
                                  'OverallQual', 'OverallCond', 'YearBuilt',
                                  'YearRemodAdd', 'MasVnrArea', 'BsmtFinSF1',
                                  'BsmtFinSF2', 'BsmtUnfSF', 'TotalBsmtSF',
                                  '1stFlrSF', '2ndFlrSF', 'LowQualFinSF',
                                  'GrLivArea', 'BsmtF...
                                 ['MSZoning', 'Street', 'Alley', 'LotShape',
                                  'LandContour', 'Utilities', 'LotConfig',
                                  'LandSlope', 'Condition1', 'Condition2',
                                  'BldgType', 'HouseStyle', 'RoofStyle',
                                  'RoofMatl', 'MasVnrType', 'ExterQual',
                                  'ExterCond', 'Foundation', 'BsmtQual',
                                  'BsmtCond', 'BsmtExposure', 'BsmtFinType1',
                                  'BsmtFinType2', 'Heating', 'HeatingQC',
                                  'CentralAir', 'Electrical', 'KitchenQual',
                                  'Functional', 'FireplaceQu', ...])])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="30288365-ced2-4f07-ba4a-29030da86afb" type="checkbox" ><label class="sk-toggleable__label" for="30288365-ced2-4f07-ba4a-29030da86afb">num_cols</label><div class="sk-toggleable__content"><pre>['MSSubClass', 'LotFrontage', 'LotArea', 'OverallQual', 'OverallCond', 'YearBuilt', 'YearRemodAdd', 'MasVnrArea', 'BsmtFinSF1', 'BsmtFinSF2', 'BsmtUnfSF', 'TotalBsmtSF', '1stFlrSF', '2ndFlrSF', 'LowQualFinSF', 'GrLivArea', 'BsmtFullBath', 'BsmtHalfBath', 'FullBath', 'HalfBath', 'BedroomAbvGr', 'KitchenAbvGr', 'TotRmsAbvGrd', 'Fireplaces', 'GarageYrBlt', 'GarageCars', 'GarageArea', 'WoodDeckSF', 'OpenPorchSF', 'EnclosedPorch', '3SsnPorch', 'ScreenPorch', 'PoolArea', 'MiscVal', 'MoSold', 'YrSold']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="3147094f-b8d2-44b7-b008-0744a098cf98" type="checkbox" ><label class="sk-toggleable__label" for="3147094f-b8d2-44b7-b008-0744a098cf98">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='constant')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="5abac1f5-a84a-4112-97a6-b43ce0f63a65" type="checkbox" ><label class="sk-toggleable__label" for="5abac1f5-a84a-4112-97a6-b43ce0f63a65">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="f3d90a91-fe5e-4905-a694-04f8927b06f7" type="checkbox" ><label class="sk-toggleable__label" for="f3d90a91-fe5e-4905-a694-04f8927b06f7">cat_cols</label><div class="sk-toggleable__content"><pre>['MSZoning', 'Street', 'Alley', 'LotShape', 'LandContour', 'Utilities', 'LotConfig', 'LandSlope', 'Condition1', 'Condition2', 'BldgType', 'HouseStyle', 'RoofStyle', 'RoofMatl', 'MasVnrType', 'ExterQual', 'ExterCond', 'Foundation', 'BsmtQual', 'BsmtCond', 'BsmtExposure', 'BsmtFinType1', 'BsmtFinType2', 'Heating', 'HeatingQC', 'CentralAir', 'Electrical', 'KitchenQual', 'Functional', 'FireplaceQu', 'GarageType', 'GarageFinish', 'GarageQual', 'GarageCond', 'PavedDrive', 'PoolQC', 'Fence', 'MiscFeature', 'SaleType', 'SaleCondition', 'Neighborhood', 'Exterior1st', 'Exterior2nd']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="a5d0321f-b120-41f2-acfa-f597da892ef5" type="checkbox" ><label class="sk-toggleable__label" for="a5d0321f-b120-41f2-acfa-f597da892ef5">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='constant')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="7bde0065-6937-4643-a772-b6c22dbf1280" type="checkbox" ><label class="sk-toggleable__label" for="7bde0065-6937-4643-a772-b6c22dbf1280">OneHotEncoder</label><div class="sk-toggleable__content"><pre>OneHotEncoder(handle_unknown='ignore')</pre></div></div></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="92d7afb0-0a99-4e5f-8b11-614417efe3e5" type="checkbox" ><label class="sk-toggleable__label" for="92d7afb0-0a99-4e5f-8b11-614417efe3e5">XGBRegressor</label><div class="sk-toggleable__content"><pre>XGBRegressor(base_score=None, booster='gbtree', colsample_bylevel=None,
             colsample_bynode=None, colsample_bytree=0.936441228462284,
             early_stopping_rounds=323, enable_categorical=False,
             gamma=0.00016954628965916405, gpu_id=None, grow_policy='depthwise',
             importance_type=None, interaction_constraints=None,
             learning_rate=0.011129207646131652, max_delta_step=None,
             max_depth=9, min_child_weight=None, missing=nan,
             monotone_constraints=None, n_estimators=20000, n_jobs=None,
             num_parallel_tree=None, predictor=None, random_state=None,
             reg_alpha=52.967728527588584, reg_lambda=0.30050997361951176,
             scale_pos_weight=None, subsample=0.5258942705414594,
             tree_method='hist', validate_parameters=None, verbosity=None)</pre></div></div></div></div></div></div></div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Let's-do-Hyper-Parameters-Optimization-and-find-the-best-params-for-Data-PreProcessing">Let's do Hyper Parameters Optimization and find the best params for Data PreProcessing<a class="anchor-link" href="#Let's-do-Hyper-Parameters-Optimization-and-find-the-best-params-for-Data-PreProcessing"> </a></h4><p>Let's give our Grid Search max 6 minute time budget, Because we don't have eternity to wait for hyperparam tunning!</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>


<span class="c1"># let&#39;s tune data preprocessing and model hyperparams</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;preprocessor__num_cols__scaler&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">StandardScaler</span><span class="p">(),</span> <span class="n">MinMaxScaler</span><span class="p">()],</span>
    <span class="s2">&quot;preprocessor__cat_cols__imputer&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">),</span>
                                                 <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;most_frequent&#39;</span><span class="p">)]</span>
<span class="p">}</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="c1"># Now do tune grid search</span>
<span class="n">tune_search</span> <span class="o">=</span> <span class="n">tmlt</span><span class="o">.</span><span class="n">do_tune_grid_search</span><span class="p">(</span><span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span>
                                       <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                       <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;neg_mean_absolute_error&#39;</span><span class="p">,</span>
                                      <span class="n">early_stopping</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                      <span class="n">time_budget_s</span><span class="o">=</span><span class="mi">360</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Grid Search Time:&quot;</span><span class="p">,</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best params:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tune_search</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Internal CV Metrics score: </span><span class="si">{</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">tune_search</span><span class="o">.</span><span class="n">best_score_</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/tune_sklearn/tune_basesearch.py:400: UserWarning: max_iters is set &gt; 1 but incremental/partial training is not enabled. To enable partial training, ensure the estimator has `partial_fit` or `warm_start` and set `early_stopping=True`. Automatically setting max_iters=1.
  warnings.warn(
/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/tune/tune.py:368: UserWarning: The `loggers` argument is deprecated. Please pass the respective `LoggerCallback` classes to the `callbacks` argument instead. See https://docs.ray.io/en/latest/tune/api_docs/logging.html
  warnings.warn(
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-cyan-fg">(_Trainable pid=13878)</span> [21:29:17] WARNING: /Users/runner/miniforge3/conda-bld/xgboost-split_1634712680264/work/src/learner.cc:576: 
<span class="ansi-cyan-fg">(_Trainable pid=13878)</span> Parameters: { &#34;early_stopping_rounds&#34; } might not be used.
<span class="ansi-cyan-fg">(_Trainable pid=13878)</span> 
<span class="ansi-cyan-fg">(_Trainable pid=13878)</span>   This could be a false alarm, with some parameters getting used by language bindings but
<span class="ansi-cyan-fg">(_Trainable pid=13878)</span>   then being mistakenly passed down to XGBoost core, or some parameter actually being used
<span class="ansi-cyan-fg">(_Trainable pid=13878)</span>   but getting flagged wrongly here. Please open an issue if you find any such cases.
<span class="ansi-cyan-fg">(_Trainable pid=13878)</span> 
<span class="ansi-cyan-fg">(_Trainable pid=13878)</span> 
<span class="ansi-cyan-fg">(_Trainable pid=13874)</span> [21:29:17] WARNING: /Users/runner/miniforge3/conda-bld/xgboost-split_1634712680264/work/src/learner.cc:576: 
<span class="ansi-cyan-fg">(_Trainable pid=13874)</span> Parameters: { &#34;early_stopping_rounds&#34; } might not be used.
<span class="ansi-cyan-fg">(_Trainable pid=13874)</span> 
<span class="ansi-cyan-fg">(_Trainable pid=13874)</span>   This could be a false alarm, with some parameters getting used by language bindings but
<span class="ansi-cyan-fg">(_Trainable pid=13874)</span>   then being mistakenly passed down to XGBoost core, or some parameter actually being used
<span class="ansi-cyan-fg">(_Trainable pid=13874)</span>   but getting flagged wrongly here. Please open an issue if you find any such cases.
<span class="ansi-cyan-fg">(_Trainable pid=13874)</span> 
<span class="ansi-cyan-fg">(_Trainable pid=13874)</span> 
<span class="ansi-cyan-fg">(_Trainable pid=13875)</span> [21:29:17] WARNING: /Users/runner/miniforge3/conda-bld/xgboost-split_1634712680264/work/src/learner.cc:576: 
<span class="ansi-cyan-fg">(_Trainable pid=13875)</span> Parameters: { &#34;early_stopping_rounds&#34; } might not be used.
<span class="ansi-cyan-fg">(_Trainable pid=13875)</span> 
<span class="ansi-cyan-fg">(_Trainable pid=13875)</span>   This could be a false alarm, with some parameters getting used by language bindings but
<span class="ansi-cyan-fg">(_Trainable pid=13875)</span>   then being mistakenly passed down to XGBoost core, or some parameter actually being used
<span class="ansi-cyan-fg">(_Trainable pid=13875)</span>   but getting flagged wrongly here. Please open an issue if you find any such cases.
<span class="ansi-cyan-fg">(_Trainable pid=13875)</span> 
<span class="ansi-cyan-fg">(_Trainable pid=13875)</span> 
<span class="ansi-cyan-fg">(_Trainable pid=13879)</span> [21:29:17] WARNING: /Users/runner/miniforge3/conda-bld/xgboost-split_1634712680264/work/src/learner.cc:576: 
<span class="ansi-cyan-fg">(_Trainable pid=13879)</span> Parameters: { &#34;early_stopping_rounds&#34; } might not be used.
<span class="ansi-cyan-fg">(_Trainable pid=13879)</span> 
<span class="ansi-cyan-fg">(_Trainable pid=13879)</span>   This could be a false alarm, with some parameters getting used by language bindings but
<span class="ansi-cyan-fg">(_Trainable pid=13879)</span>   then being mistakenly passed down to XGBoost core, or some parameter actually being used
<span class="ansi-cyan-fg">(_Trainable pid=13879)</span>   but getting flagged wrongly here. Please open an issue if you find any such cases.
<span class="ansi-cyan-fg">(_Trainable pid=13879)</span> 
<span class="ansi-cyan-fg">(_Trainable pid=13879)</span> 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>SIGINT received (e.g. via Ctrl+C), ending Ray Tune run. This will try to checkpoint the experiment state one last time. Press CTRL+C one more time (or send SIGINT/SIGKILL/SIGTERM) to skip. 
<span class="ansi-cyan-fg">(pid=13874)</span> 2021-11-20 21:29:57,210	ERROR worker.py:425 -- SystemExit was raised from the worker
<span class="ansi-cyan-fg">(pid=13874)</span> Traceback (most recent call last):
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 692, in ray._raylet.task_execution_handler
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 521, in ray._raylet.execute_task
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 558, in ray._raylet.execute_task
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 565, in ray._raylet.execute_task
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 569, in ray._raylet.execute_task
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 519, in ray._raylet.execute_task.function_executor
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/_private/function_manager.py&#34;, line 576, in actor_method_executor
<span class="ansi-cyan-fg">(pid=13874)</span>     return method(__ray_actor, *args, **kwargs)
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/util/tracing/tracing_helper.py&#34;, line 451, in _resume_span
<span class="ansi-cyan-fg">(pid=13874)</span>     return method(self, *_args, **_kwargs)
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/tune/trainable.py&#34;, line 224, in train_buffered
<span class="ansi-cyan-fg">(pid=13874)</span>     result = self.train()
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/util/tracing/tracing_helper.py&#34;, line 451, in _resume_span
<span class="ansi-cyan-fg">(pid=13874)</span>     return method(self, *_args, **_kwargs)
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/tune/trainable.py&#34;, line 283, in train
<span class="ansi-cyan-fg">(pid=13874)</span>     result = self.step()
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/util/tracing/tracing_helper.py&#34;, line 451, in _resume_span
<span class="ansi-cyan-fg">(pid=13874)</span>     return method(self, *_args, **_kwargs)
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/tune_sklearn/_trainable.py&#34;, line 106, in step
<span class="ansi-cyan-fg">(pid=13874)</span>     return self._train()
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/util/tracing/tracing_helper.py&#34;, line 451, in _resume_span
<span class="ansi-cyan-fg">(pid=13874)</span>     return method(self, *_args, **_kwargs)
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/tune_sklearn/_trainable.py&#34;, line 237, in _train
<span class="ansi-cyan-fg">(pid=13874)</span>     scores = cross_validate(
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/sklearn/model_selection/_validation.py&#34;, line 267, in cross_validate
<span class="ansi-cyan-fg">(pid=13874)</span>     results = parallel(
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/parallel.py&#34;, line 1043, in __call__
<span class="ansi-cyan-fg">(pid=13874)</span>     if self.dispatch_one_batch(iterator):
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/parallel.py&#34;, line 861, in dispatch_one_batch
<span class="ansi-cyan-fg">(pid=13874)</span>     self._dispatch(tasks)
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/parallel.py&#34;, line 779, in _dispatch
<span class="ansi-cyan-fg">(pid=13874)</span>     job = self._backend.apply_async(batch, callback=cb)
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/_parallel_backends.py&#34;, line 208, in apply_async
<span class="ansi-cyan-fg">(pid=13874)</span>     result = ImmediateResult(func)
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/_parallel_backends.py&#34;, line 572, in __init__
<span class="ansi-cyan-fg">(pid=13874)</span>     self.results = batch()
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/parallel.py&#34;, line 262, in __call__
<span class="ansi-cyan-fg">(pid=13874)</span>     return [func(*args, **kwargs)
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/parallel.py&#34;, line 262, in &lt;listcomp&gt;
<span class="ansi-cyan-fg">(pid=13874)</span>     return [func(*args, **kwargs)
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/sklearn/utils/fixes.py&#34;, line 209, in __call__
<span class="ansi-cyan-fg">(pid=13874)</span>     return self.function(*args, **kwargs)
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/sklearn/model_selection/_validation.py&#34;, line 681, in _fit_and_score
<span class="ansi-cyan-fg">(pid=13874)</span>     estimator.fit(X_train, y_train, **fit_params)
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/sklearn/pipeline.py&#34;, line 394, in fit
<span class="ansi-cyan-fg">(pid=13874)</span>     self._final_estimator.fit(Xt, y, **fit_params_last_step)
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/xgboost/core.py&#34;, line 506, in inner_f
<span class="ansi-cyan-fg">(pid=13874)</span>     return f(**kwargs)
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/xgboost/sklearn.py&#34;, line 789, in fit
<span class="ansi-cyan-fg">(pid=13874)</span>     self._Booster = train(
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/xgboost/training.py&#34;, line 188, in train
<span class="ansi-cyan-fg">(pid=13874)</span>     bst = _train_internal(params, dtrain,
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/xgboost/training.py&#34;, line 81, in _train_internal
<span class="ansi-cyan-fg">(pid=13874)</span>     bst.update(dtrain, i, obj)
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/xgboost/core.py&#34;, line 1680, in update
<span class="ansi-cyan-fg">(pid=13874)</span>     _check_call(_LIB.XGBoosterUpdateOneIter(self.handle,
<span class="ansi-cyan-fg">(pid=13874)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/worker.py&#34;, line 422, in sigterm_handler
<span class="ansi-cyan-fg">(pid=13874)</span>     sys.exit(1)
<span class="ansi-cyan-fg">(pid=13874)</span> SystemExit: 1
<span class="ansi-cyan-fg">(pid=13874)</span> [2021-11-20 21:29:57,231 C 13874 105229] core_worker.cc:796:  Check failed: _s.ok() Bad status: IOError: Broken pipe
<span class="ansi-cyan-fg">(pid=13874)</span> *** StackTrace Information ***
<span class="ansi-cyan-fg">(pid=13874)</span>     ray::GetCallTrace()
<span class="ansi-cyan-fg">(pid=13874)</span>     ray::SpdLogMessage::Flush()
<span class="ansi-cyan-fg">(pid=13874)</span>     ray::SpdLogMessage::~SpdLogMessage()
<span class="ansi-cyan-fg">(pid=13874)</span>     ray::RayLog::~RayLog()
<span class="ansi-cyan-fg">(pid=13874)</span>     ray::core::CoreWorker::Exit()
<span class="ansi-cyan-fg">(pid=13874)</span>     ray::core::CoreWorker::ExecuteTask()
<span class="ansi-cyan-fg">(pid=13874)</span>     std::__1::__function::__func&lt;&gt;::operator()()
<span class="ansi-cyan-fg">(pid=13874)</span>     std::__1::__function::__func&lt;&gt;::operator()()
<span class="ansi-cyan-fg">(pid=13874)</span>     ray::core::InboundRequest::Accept()
<span class="ansi-cyan-fg">(pid=13874)</span>     ray::core::ActorSchedulingQueue::ScheduleRequests()
<span class="ansi-cyan-fg">(pid=13874)</span>     ray::core::ActorSchedulingQueue::Add()
<span class="ansi-cyan-fg">(pid=13874)</span>     ray::core::CoreWorkerDirectTaskReceiver::HandleTask()
<span class="ansi-cyan-fg">(pid=13874)</span>     std::__1::__function::__func&lt;&gt;::operator()()
<span class="ansi-cyan-fg">(pid=13874)</span>     boost::asio::detail::completion_handler&lt;&gt;::do_complete()
<span class="ansi-cyan-fg">(pid=13874)</span>     boost::asio::detail::scheduler::do_run_one()
<span class="ansi-cyan-fg">(pid=13874)</span>     boost::asio::detail::scheduler::run()
<span class="ansi-cyan-fg">(pid=13874)</span>     boost::asio::io_context::run()
<span class="ansi-cyan-fg">(pid=13874)</span>     ray::core::CoreWorkerProcess::RunTaskExecutionLoop()
<span class="ansi-cyan-fg">(pid=13874)</span>     __pyx_pw_3ray_7_raylet_10CoreWorker_9run_task_loop()
<span class="ansi-cyan-fg">(pid=13874)</span>     method_vectorcall_NOARGS
<span class="ansi-cyan-fg">(pid=13874)</span>     call_function
<span class="ansi-cyan-fg">(pid=13874)</span>     _PyEval_EvalFrameDefault
<span class="ansi-cyan-fg">(pid=13874)</span>     _PyFunction_Vectorcall
<span class="ansi-cyan-fg">(pid=13874)</span>     call_function
<span class="ansi-cyan-fg">(pid=13874)</span>     _PyEval_EvalFrameDefault
<span class="ansi-cyan-fg">(pid=13874)</span>     _PyEval_EvalCode
<span class="ansi-cyan-fg">(pid=13874)</span>     pyrun_file
<span class="ansi-cyan-fg">(pid=13874)</span>     pyrun_simple_file
<span class="ansi-cyan-fg">(pid=13874)</span>     PyRun_SimpleFileExFlags
<span class="ansi-cyan-fg">(pid=13874)</span>     pymain_run_file
<span class="ansi-cyan-fg">(pid=13874)</span>     pymain_run_python
<span class="ansi-cyan-fg">(pid=13874)</span>     Py_RunMain
<span class="ansi-cyan-fg">(pid=13874)</span>     pymain_main
<span class="ansi-cyan-fg">(pid=13874)</span>     main
<span class="ansi-cyan-fg">(pid=13874)</span>     start
<span class="ansi-cyan-fg">(pid=13874)</span>     0x0
<span class="ansi-cyan-fg">(pid=13874)</span> 
<span class="ansi-cyan-fg">(pid=13878)</span> 2021-11-20 21:29:57,209	ERROR worker.py:425 -- SystemExit was raised from the worker
<span class="ansi-cyan-fg">(pid=13878)</span> Traceback (most recent call last):
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 692, in ray._raylet.task_execution_handler
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 521, in ray._raylet.execute_task
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 558, in ray._raylet.execute_task
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 565, in ray._raylet.execute_task
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 569, in ray._raylet.execute_task
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 519, in ray._raylet.execute_task.function_executor
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/_private/function_manager.py&#34;, line 576, in actor_method_executor
<span class="ansi-cyan-fg">(pid=13878)</span>     return method(__ray_actor, *args, **kwargs)
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/util/tracing/tracing_helper.py&#34;, line 451, in _resume_span
<span class="ansi-cyan-fg">(pid=13878)</span>     return method(self, *_args, **_kwargs)
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/tune/trainable.py&#34;, line 224, in train_buffered
<span class="ansi-cyan-fg">(pid=13878)</span>     result = self.train()
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/util/tracing/tracing_helper.py&#34;, line 451, in _resume_span
<span class="ansi-cyan-fg">(pid=13878)</span>     return method(self, *_args, **_kwargs)
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/tune/trainable.py&#34;, line 283, in train
<span class="ansi-cyan-fg">(pid=13878)</span>     result = self.step()
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/util/tracing/tracing_helper.py&#34;, line 451, in _resume_span
<span class="ansi-cyan-fg">(pid=13878)</span>     return method(self, *_args, **_kwargs)
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/tune_sklearn/_trainable.py&#34;, line 106, in step
<span class="ansi-cyan-fg">(pid=13878)</span>     return self._train()
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/util/tracing/tracing_helper.py&#34;, line 451, in _resume_span
<span class="ansi-cyan-fg">(pid=13878)</span>     return method(self, *_args, **_kwargs)
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/tune_sklearn/_trainable.py&#34;, line 237, in _train
<span class="ansi-cyan-fg">(pid=13878)</span>     scores = cross_validate(
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/sklearn/model_selection/_validation.py&#34;, line 267, in cross_validate
<span class="ansi-cyan-fg">(pid=13878)</span>     results = parallel(
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/parallel.py&#34;, line 1043, in __call__
<span class="ansi-cyan-fg">(pid=13878)</span>     if self.dispatch_one_batch(iterator):
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/parallel.py&#34;, line 861, in dispatch_one_batch
<span class="ansi-cyan-fg">(pid=13878)</span>     self._dispatch(tasks)
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/parallel.py&#34;, line 779, in _dispatch
<span class="ansi-cyan-fg">(pid=13878)</span>     job = self._backend.apply_async(batch, callback=cb)
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/_parallel_backends.py&#34;, line 208, in apply_async
<span class="ansi-cyan-fg">(pid=13878)</span>     result = ImmediateResult(func)
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/_parallel_backends.py&#34;, line 572, in __init__
<span class="ansi-cyan-fg">(pid=13878)</span>     self.results = batch()
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/parallel.py&#34;, line 262, in __call__
<span class="ansi-cyan-fg">(pid=13878)</span>     return [func(*args, **kwargs)
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/parallel.py&#34;, line 262, in &lt;listcomp&gt;
<span class="ansi-cyan-fg">(pid=13878)</span>     return [func(*args, **kwargs)
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/sklearn/utils/fixes.py&#34;, line 209, in __call__
<span class="ansi-cyan-fg">(pid=13878)</span>     return self.function(*args, **kwargs)
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/sklearn/model_selection/_validation.py&#34;, line 681, in _fit_and_score
<span class="ansi-cyan-fg">(pid=13878)</span>     estimator.fit(X_train, y_train, **fit_params)
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/sklearn/pipeline.py&#34;, line 394, in fit
<span class="ansi-cyan-fg">(pid=13878)</span>     self._final_estimator.fit(Xt, y, **fit_params_last_step)
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/xgboost/core.py&#34;, line 506, in inner_f
<span class="ansi-cyan-fg">(pid=13878)</span>     return f(**kwargs)
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/xgboost/sklearn.py&#34;, line 789, in fit
<span class="ansi-cyan-fg">(pid=13878)</span>     self._Booster = train(
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/xgboost/training.py&#34;, line 188, in train
<span class="ansi-cyan-fg">(pid=13878)</span>     bst = _train_internal(params, dtrain,
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/xgboost/training.py&#34;, line 81, in _train_internal
<span class="ansi-cyan-fg">(pid=13878)</span>     bst.update(dtrain, i, obj)
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/xgboost/core.py&#34;, line 1680, in update
<span class="ansi-cyan-fg">(pid=13878)</span>     _check_call(_LIB.XGBoosterUpdateOneIter(self.handle,
<span class="ansi-cyan-fg">(pid=13878)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/worker.py&#34;, line 422, in sigterm_handler
<span class="ansi-cyan-fg">(pid=13878)</span>     sys.exit(1)
<span class="ansi-cyan-fg">(pid=13878)</span> SystemExit: 1
<span class="ansi-cyan-fg">(pid=13878)</span> [2021-11-20 21:29:57,229 C 13878 105244] core_worker.cc:796:  Check failed: _s.ok() Bad status: IOError: Broken pipe
<span class="ansi-cyan-fg">(pid=13878)</span> *** StackTrace Information ***
<span class="ansi-cyan-fg">(pid=13878)</span>     ray::GetCallTrace()
<span class="ansi-cyan-fg">(pid=13878)</span>     ray::SpdLogMessage::Flush()
<span class="ansi-cyan-fg">(pid=13878)</span>     ray::SpdLogMessage::~SpdLogMessage()
<span class="ansi-cyan-fg">(pid=13878)</span>     ray::RayLog::~RayLog()
<span class="ansi-cyan-fg">(pid=13878)</span>     ray::core::CoreWorker::Exit()
<span class="ansi-cyan-fg">(pid=13878)</span>     ray::core::CoreWorker::ExecuteTask()
<span class="ansi-cyan-fg">(pid=13878)</span>     std::__1::__function::__func&lt;&gt;::operator()()
<span class="ansi-cyan-fg">(pid=13878)</span>     std::__1::__function::__func&lt;&gt;::operator()()
<span class="ansi-cyan-fg">(pid=13878)</span>     ray::core::InboundRequest::Accept()
<span class="ansi-cyan-fg">(pid=13878)</span>     ray::core::ActorSchedulingQueue::ScheduleRequests()
<span class="ansi-cyan-fg">(pid=13878)</span>     ray::core::ActorSchedulingQueue::Add()
<span class="ansi-cyan-fg">(pid=13878)</span>     ray::core::CoreWorkerDirectTaskReceiver::HandleTask()
<span class="ansi-cyan-fg">(pid=13878)</span>     std::__1::__function::__func&lt;&gt;::operator()()
<span class="ansi-cyan-fg">(pid=13878)</span>     boost::asio::detail::completion_handler&lt;&gt;::do_complete()
<span class="ansi-cyan-fg">(pid=13878)</span>     boost::asio::detail::scheduler::do_run_one()
<span class="ansi-cyan-fg">(pid=13878)</span>     boost::asio::detail::scheduler::run()
<span class="ansi-cyan-fg">(pid=13878)</span>     boost::asio::io_context::run()
<span class="ansi-cyan-fg">(pid=13878)</span>     ray::core::CoreWorkerProcess::RunTaskExecutionLoop()
<span class="ansi-cyan-fg">(pid=13878)</span>     __pyx_pw_3ray_7_raylet_10CoreWorker_9run_task_loop()
<span class="ansi-cyan-fg">(pid=13878)</span>     method_vectorcall_NOARGS
<span class="ansi-cyan-fg">(pid=13878)</span>     call_function
<span class="ansi-cyan-fg">(pid=13878)</span>     _PyEval_EvalFrameDefault
<span class="ansi-cyan-fg">(pid=13878)</span>     _PyFunction_Vectorcall
<span class="ansi-cyan-fg">(pid=13878)</span>     call_function
<span class="ansi-cyan-fg">(pid=13878)</span>     _PyEval_EvalFrameDefault
<span class="ansi-cyan-fg">(pid=13878)</span>     _PyEval_EvalCode
<span class="ansi-cyan-fg">(pid=13878)</span>     pyrun_file
<span class="ansi-cyan-fg">(pid=13878)</span>     pyrun_simple_file
<span class="ansi-cyan-fg">(pid=13878)</span>     PyRun_SimpleFileExFlags
<span class="ansi-cyan-fg">(pid=13878)</span>     pymain_run_file
<span class="ansi-cyan-fg">(pid=13878)</span>     pymain_run_python
<span class="ansi-cyan-fg">(pid=13878)</span>     Py_RunMain
<span class="ansi-cyan-fg">(pid=13878)</span>     pymain_main
<span class="ansi-cyan-fg">(pid=13878)</span>     main
<span class="ansi-cyan-fg">(pid=13878)</span>     start
<span class="ansi-cyan-fg">(pid=13878)</span> 
<span class="ansi-cyan-fg">(pid=13879)</span> 2021-11-20 21:29:57,209	ERROR worker.py:425 -- SystemExit was raised from the worker
<span class="ansi-cyan-fg">(pid=13879)</span> Traceback (most recent call last):
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 692, in ray._raylet.task_execution_handler
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 521, in ray._raylet.execute_task
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 558, in ray._raylet.execute_task
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 565, in ray._raylet.execute_task
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 569, in ray._raylet.execute_task
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 519, in ray._raylet.execute_task.function_executor
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/_private/function_manager.py&#34;, line 576, in actor_method_executor
<span class="ansi-cyan-fg">(pid=13879)</span>     return method(__ray_actor, *args, **kwargs)
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/util/tracing/tracing_helper.py&#34;, line 451, in _resume_span
<span class="ansi-cyan-fg">(pid=13879)</span>     return method(self, *_args, **_kwargs)
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/tune/trainable.py&#34;, line 224, in train_buffered
<span class="ansi-cyan-fg">(pid=13879)</span>     result = self.train()
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/util/tracing/tracing_helper.py&#34;, line 451, in _resume_span
<span class="ansi-cyan-fg">(pid=13879)</span>     return method(self, *_args, **_kwargs)
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/tune/trainable.py&#34;, line 283, in train
<span class="ansi-cyan-fg">(pid=13879)</span>     result = self.step()
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/util/tracing/tracing_helper.py&#34;, line 451, in _resume_span
<span class="ansi-cyan-fg">(pid=13879)</span>     return method(self, *_args, **_kwargs)
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/tune_sklearn/_trainable.py&#34;, line 106, in step
<span class="ansi-cyan-fg">(pid=13879)</span>     return self._train()
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/util/tracing/tracing_helper.py&#34;, line 451, in _resume_span
<span class="ansi-cyan-fg">(pid=13879)</span>     return method(self, *_args, **_kwargs)
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/tune_sklearn/_trainable.py&#34;, line 237, in _train
<span class="ansi-cyan-fg">(pid=13879)</span>     scores = cross_validate(
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/sklearn/model_selection/_validation.py&#34;, line 267, in cross_validate
<span class="ansi-cyan-fg">(pid=13879)</span>     results = parallel(
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/parallel.py&#34;, line 1043, in __call__
<span class="ansi-cyan-fg">(pid=13879)</span>     if self.dispatch_one_batch(iterator):
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/parallel.py&#34;, line 861, in dispatch_one_batch
<span class="ansi-cyan-fg">(pid=13879)</span>     self._dispatch(tasks)
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/parallel.py&#34;, line 779, in _dispatch
<span class="ansi-cyan-fg">(pid=13879)</span>     job = self._backend.apply_async(batch, callback=cb)
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/_parallel_backends.py&#34;, line 208, in apply_async
<span class="ansi-cyan-fg">(pid=13879)</span>     result = ImmediateResult(func)
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/_parallel_backends.py&#34;, line 572, in __init__
<span class="ansi-cyan-fg">(pid=13879)</span>     self.results = batch()
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/parallel.py&#34;, line 262, in __call__
<span class="ansi-cyan-fg">(pid=13879)</span>     return [func(*args, **kwargs)
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/parallel.py&#34;, line 262, in &lt;listcomp&gt;
<span class="ansi-cyan-fg">(pid=13879)</span>     return [func(*args, **kwargs)
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/sklearn/utils/fixes.py&#34;, line 209, in __call__
<span class="ansi-cyan-fg">(pid=13879)</span>     return self.function(*args, **kwargs)
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/sklearn/model_selection/_validation.py&#34;, line 681, in _fit_and_score
<span class="ansi-cyan-fg">(pid=13879)</span>     estimator.fit(X_train, y_train, **fit_params)
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/sklearn/pipeline.py&#34;, line 394, in fit
<span class="ansi-cyan-fg">(pid=13879)</span>     self._final_estimator.fit(Xt, y, **fit_params_last_step)
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/xgboost/core.py&#34;, line 506, in inner_f
<span class="ansi-cyan-fg">(pid=13879)</span>     return f(**kwargs)
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/xgboost/sklearn.py&#34;, line 789, in fit
<span class="ansi-cyan-fg">(pid=13879)</span>     self._Booster = train(
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/xgboost/training.py&#34;, line 188, in train
<span class="ansi-cyan-fg">(pid=13879)</span>     bst = _train_internal(params, dtrain,
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/xgboost/training.py&#34;, line 81, in _train_internal
<span class="ansi-cyan-fg">(pid=13879)</span>     bst.update(dtrain, i, obj)
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/xgboost/core.py&#34;, line 1680, in update
<span class="ansi-cyan-fg">(pid=13879)</span>     _check_call(_LIB.XGBoosterUpdateOneIter(self.handle,
<span class="ansi-cyan-fg">(pid=13879)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/worker.py&#34;, line 422, in sigterm_handler
<span class="ansi-cyan-fg">(pid=13879)</span>     sys.exit(1)
<span class="ansi-cyan-fg">(pid=13879)</span> SystemExit: 1
<span class="ansi-cyan-fg">(pid=13879)</span> [2021-11-20 21:29:57,228 C 13879 105259] core_worker.cc:796:  Check failed: _s.ok() Bad status: IOError: Broken pipe
<span class="ansi-cyan-fg">(pid=13879)</span> *** StackTrace Information ***
<span class="ansi-cyan-fg">(pid=13879)</span>     ray::GetCallTrace()
<span class="ansi-cyan-fg">(pid=13879)</span>     ray::SpdLogMessage::Flush()
<span class="ansi-cyan-fg">(pid=13879)</span>     ray::SpdLogMessage::~SpdLogMessage()
<span class="ansi-cyan-fg">(pid=13879)</span>     ray::RayLog::~RayLog()
<span class="ansi-cyan-fg">(pid=13879)</span>     ray::core::CoreWorker::Exit()
<span class="ansi-cyan-fg">(pid=13879)</span>     ray::core::CoreWorker::ExecuteTask()
<span class="ansi-cyan-fg">(pid=13879)</span>     std::__1::__function::__func&lt;&gt;::operator()()
<span class="ansi-cyan-fg">(pid=13879)</span>     std::__1::__function::__func&lt;&gt;::operator()()
<span class="ansi-cyan-fg">(pid=13879)</span>     ray::core::InboundRequest::Accept()
<span class="ansi-cyan-fg">(pid=13879)</span>     ray::core::ActorSchedulingQueue::ScheduleRequests()
<span class="ansi-cyan-fg">(pid=13879)</span>     ray::core::ActorSchedulingQueue::Add()
<span class="ansi-cyan-fg">(pid=13879)</span>     ray::core::CoreWorkerDirectTaskReceiver::HandleTask()
<span class="ansi-cyan-fg">(pid=13879)</span>     std::__1::__function::__func&lt;&gt;::operator()()
<span class="ansi-cyan-fg">(pid=13879)</span>     boost::asio::detail::completion_handler&lt;&gt;::do_complete()
<span class="ansi-cyan-fg">(pid=13879)</span>     boost::asio::detail::scheduler::do_run_one()
<span class="ansi-cyan-fg">(pid=13879)</span>     boost::asio::detail::scheduler::run()
<span class="ansi-cyan-fg">(pid=13879)</span>     boost::asio::io_context::run()
<span class="ansi-cyan-fg">(pid=13879)</span>     ray::core::CoreWorkerProcess::RunTaskExecutionLoop()
<span class="ansi-cyan-fg">(pid=13879)</span>     __pyx_pw_3ray_7_raylet_10CoreWorker_9run_task_loop()
<span class="ansi-cyan-fg">(pid=13879)</span>     method_vectorcall_NOARGS
<span class="ansi-cyan-fg">(pid=13879)</span>     call_function
<span class="ansi-cyan-fg">(pid=13879)</span>     _PyEval_EvalFrameDefault
<span class="ansi-cyan-fg">(pid=13879)</span>     _PyFunction_Vectorcall
<span class="ansi-cyan-fg">(pid=13879)</span>     call_function
<span class="ansi-cyan-fg">(pid=13879)</span>     _PyEval_EvalFrameDefault
<span class="ansi-cyan-fg">(pid=13879)</span>     _PyEval_EvalCode
<span class="ansi-cyan-fg">(pid=13879)</span>     pyrun_file
<span class="ansi-cyan-fg">(pid=13879)</span>     pyrun_simple_file
<span class="ansi-cyan-fg">(pid=13879)</span>     PyRun_SimpleFileExFlags
<span class="ansi-cyan-fg">(pid=13879)</span>     pymain_run_file
<span class="ansi-cyan-fg">(pid=13879)</span>     pymain_run_python
<span class="ansi-cyan-fg">(pid=13879)</span>     Py_RunMain
<span class="ansi-cyan-fg">(pid=13879)</span>     pymain_main
<span class="ansi-cyan-fg">(pid=13879)</span>     main
<span class="ansi-cyan-fg">(pid=13879)</span>     start
<span class="ansi-cyan-fg">(pid=13879)</span> 
<span class="ansi-cyan-fg">(pid=13875)</span> 2021-11-20 21:29:57,209	ERROR worker.py:425 -- SystemExit was raised from the worker
<span class="ansi-cyan-fg">(pid=13875)</span> Traceback (most recent call last):
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 692, in ray._raylet.task_execution_handler
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 521, in ray._raylet.execute_task
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 558, in ray._raylet.execute_task
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 565, in ray._raylet.execute_task
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 569, in ray._raylet.execute_task
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;python/ray/_raylet.pyx&#34;, line 519, in ray._raylet.execute_task.function_executor
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/_private/function_manager.py&#34;, line 576, in actor_method_executor
<span class="ansi-cyan-fg">(pid=13875)</span>     return method(__ray_actor, *args, **kwargs)
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/util/tracing/tracing_helper.py&#34;, line 451, in _resume_span
<span class="ansi-cyan-fg">(pid=13875)</span>     return method(self, *_args, **_kwargs)
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/tune/trainable.py&#34;, line 224, in train_buffered
<span class="ansi-cyan-fg">(pid=13875)</span>     result = self.train()
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/util/tracing/tracing_helper.py&#34;, line 451, in _resume_span
<span class="ansi-cyan-fg">(pid=13875)</span>     return method(self, *_args, **_kwargs)
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/tune/trainable.py&#34;, line 283, in train
<span class="ansi-cyan-fg">(pid=13875)</span>     result = self.step()
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/util/tracing/tracing_helper.py&#34;, line 451, in _resume_span
<span class="ansi-cyan-fg">(pid=13875)</span>     return method(self, *_args, **_kwargs)
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/tune_sklearn/_trainable.py&#34;, line 106, in step
<span class="ansi-cyan-fg">(pid=13875)</span>     return self._train()
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/util/tracing/tracing_helper.py&#34;, line 451, in _resume_span
<span class="ansi-cyan-fg">(pid=13875)</span>     return method(self, *_args, **_kwargs)
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/tune_sklearn/_trainable.py&#34;, line 237, in _train
<span class="ansi-cyan-fg">(pid=13875)</span>     scores = cross_validate(
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/sklearn/model_selection/_validation.py&#34;, line 267, in cross_validate
<span class="ansi-cyan-fg">(pid=13875)</span>     results = parallel(
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/parallel.py&#34;, line 1043, in __call__
<span class="ansi-cyan-fg">(pid=13875)</span>     if self.dispatch_one_batch(iterator):
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/parallel.py&#34;, line 861, in dispatch_one_batch
<span class="ansi-cyan-fg">(pid=13875)</span>     self._dispatch(tasks)
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/parallel.py&#34;, line 779, in _dispatch
<span class="ansi-cyan-fg">(pid=13875)</span>     job = self._backend.apply_async(batch, callback=cb)
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/_parallel_backends.py&#34;, line 208, in apply_async
<span class="ansi-cyan-fg">(pid=13875)</span>     result = ImmediateResult(func)
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/_parallel_backends.py&#34;, line 572, in __init__
<span class="ansi-cyan-fg">(pid=13875)</span>     self.results = batch()
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/parallel.py&#34;, line 262, in __call__
<span class="ansi-cyan-fg">(pid=13875)</span>     return [func(*args, **kwargs)
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/joblib/parallel.py&#34;, line 262, in &lt;listcomp&gt;
<span class="ansi-cyan-fg">(pid=13875)</span>     return [func(*args, **kwargs)
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/sklearn/utils/fixes.py&#34;, line 209, in __call__
<span class="ansi-cyan-fg">(pid=13875)</span>     return self.function(*args, **kwargs)
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/sklearn/model_selection/_validation.py&#34;, line 681, in _fit_and_score
<span class="ansi-cyan-fg">(pid=13875)</span>     estimator.fit(X_train, y_train, **fit_params)
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/sklearn/pipeline.py&#34;, line 394, in fit
<span class="ansi-cyan-fg">(pid=13875)</span>     self._final_estimator.fit(Xt, y, **fit_params_last_step)
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/xgboost/core.py&#34;, line 506, in inner_f
<span class="ansi-cyan-fg">(pid=13875)</span>     return f(**kwargs)
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/xgboost/sklearn.py&#34;, line 789, in fit
<span class="ansi-cyan-fg">(pid=13875)</span>     self._Booster = train(
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/xgboost/training.py&#34;, line 188, in train
<span class="ansi-cyan-fg">(pid=13875)</span>     bst = _train_internal(params, dtrain,
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/xgboost/training.py&#34;, line 81, in _train_internal
<span class="ansi-cyan-fg">(pid=13875)</span>     bst.update(dtrain, i, obj)
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/xgboost/core.py&#34;, line 1680, in update
<span class="ansi-cyan-fg">(pid=13875)</span>     _check_call(_LIB.XGBoosterUpdateOneIter(self.handle,
<span class="ansi-cyan-fg">(pid=13875)</span>   File &#34;/Users/pamathur/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/ray/worker.py&#34;, line 422, in sigterm_handler
<span class="ansi-cyan-fg">(pid=13875)</span>     sys.exit(1)
<span class="ansi-cyan-fg">(pid=13875)</span> SystemExit: 1
<span class="ansi-cyan-fg">(pid=13875)</span> [2021-11-20 21:29:57,228 C 13875 105231] core_worker.cc:796:  Check failed: _s.ok() Bad status: IOError: Broken pipe
<span class="ansi-cyan-fg">(pid=13875)</span> *** StackTrace Information ***
<span class="ansi-cyan-fg">(pid=13875)</span>     ray::GetCallTrace()
<span class="ansi-cyan-fg">(pid=13875)</span>     ray::SpdLogMessage::Flush()
<span class="ansi-cyan-fg">(pid=13875)</span>     ray::SpdLogMessage::~SpdLogMessage()
<span class="ansi-cyan-fg">(pid=13875)</span>     ray::RayLog::~RayLog()
<span class="ansi-cyan-fg">(pid=13875)</span>     ray::core::CoreWorker::Exit()
<span class="ansi-cyan-fg">(pid=13875)</span>     ray::core::CoreWorker::ExecuteTask()
<span class="ansi-cyan-fg">(pid=13875)</span>     std::__1::__function::__func&lt;&gt;::operator()()
<span class="ansi-cyan-fg">(pid=13875)</span>     std::__1::__function::__func&lt;&gt;::operator()()
<span class="ansi-cyan-fg">(pid=13875)</span>     ray::core::InboundRequest::Accept()
<span class="ansi-cyan-fg">(pid=13875)</span>     ray::core::ActorSchedulingQueue::ScheduleRequests()
<span class="ansi-cyan-fg">(pid=13875)</span>     ray::core::ActorSchedulingQueue::Add()
<span class="ansi-cyan-fg">(pid=13875)</span>     ray::core::CoreWorkerDirectTaskReceiver::HandleTask()
<span class="ansi-cyan-fg">(pid=13875)</span>     std::__1::__function::__func&lt;&gt;::operator()()
<span class="ansi-cyan-fg">(pid=13875)</span>     boost::asio::detail::completion_handler&lt;&gt;::do_complete()
<span class="ansi-cyan-fg">(pid=13875)</span>     boost::asio::detail::scheduler::do_run_one()
<span class="ansi-cyan-fg">(pid=13875)</span>     boost::asio::detail::scheduler::run()
<span class="ansi-cyan-fg">(pid=13875)</span>     boost::asio::io_context::run()
<span class="ansi-cyan-fg">(pid=13875)</span>     ray::core::CoreWorkerProcess::RunTaskExecutionLoop()
<span class="ansi-cyan-fg">(pid=13875)</span>     __pyx_pw_3ray_7_raylet_10CoreWorker_9run_task_loop()
<span class="ansi-cyan-fg">(pid=13875)</span>     method_vectorcall_NOARGS
<span class="ansi-cyan-fg">(pid=13875)</span>     call_function
<span class="ansi-cyan-fg">(pid=13875)</span>     _PyEval_EvalFrameDefault
<span class="ansi-cyan-fg">(pid=13875)</span>     _PyFunction_Vectorcall
<span class="ansi-cyan-fg">(pid=13875)</span>     call_function
<span class="ansi-cyan-fg">(pid=13875)</span>     _PyEval_EvalFrameDefault
<span class="ansi-cyan-fg">(pid=13875)</span>     _PyEval_EvalCode
<span class="ansi-cyan-fg">(pid=13875)</span>     pyrun_file
<span class="ansi-cyan-fg">(pid=13875)</span>     pyrun_simple_file
<span class="ansi-cyan-fg">(pid=13875)</span>     PyRun_SimpleFileExFlags
<span class="ansi-cyan-fg">(pid=13875)</span>     pymain_run_file
<span class="ansi-cyan-fg">(pid=13875)</span>     pymain_run_python
<span class="ansi-cyan-fg">(pid=13875)</span>     Py_RunMain
<span class="ansi-cyan-fg">(pid=13875)</span>     pymain_main
<span class="ansi-cyan-fg">(pid=13875)</span>     main
<span class="ansi-cyan-fg">(pid=13875)</span>     start
<span class="ansi-cyan-fg">(pid=13875)</span>     0x0
<span class="ansi-cyan-fg">(pid=13875)</span> 
Trials did not complete: [_Trainable_f70e6_00000, _Trainable_f70e6_00001, _Trainable_f70e6_00002, _Trainable_f70e6_00003]
Experiment has been interrupted, but the most recent state was saved. You can continue running this experiment by passing `resume=True` to `tune.run()`
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ZeroDivisionError</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">/var/folders/p3/zmg8jfwx0hb9gwzs0w69d7f0rgyjx2/T/ipykernel_13712/3320280270.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">     14</span> start <span class="ansi-blue-fg">=</span> time<span class="ansi-blue-fg">.</span>time<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     15</span> <span class="ansi-red-fg"># Now do tune grid search</span>
<span class="ansi-green-fg">---&gt; 16</span><span class="ansi-red-fg"> tune_search = tmlt.do_tune_grid_search(param_grid=param_grid,
</span><span class="ansi-green-intense-fg ansi-bold">     17</span>                                        cv<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">5</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     18</span>                                        scoring<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;neg_mean_absolute_error&#39;</span><span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">~/GitHub/tabular_ml_toolkit/tabular_ml_toolkit/tmlt.py</span> in <span class="ansi-cyan-fg">do_tune_grid_search</span><span class="ansi-blue-fg">(self, param_grid, scoring, mode, cv, early_stopping, time_budget_s, name, use_gpu, stopper, max_iters, n_jobs)</span>
<span class="ansi-green-intense-fg ansi-bold">    231</span> 
<span class="ansi-green-intense-fg ansi-bold">    232</span>         <span class="ansi-red-fg"># now call fit</span>
<span class="ansi-green-fg">--&gt; 233</span><span class="ansi-red-fg">         </span>tune_search<span class="ansi-blue-fg">.</span>fit<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dfl<span class="ansi-blue-fg">.</span>X<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>dfl<span class="ansi-blue-fg">.</span>y<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    234</span>         <span class="ansi-green-fg">return</span> tune_search
<span class="ansi-green-intense-fg ansi-bold">    235</span> 

<span class="ansi-green-fg">~/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/tune_sklearn/tune_basesearch.py</span> in <span class="ansi-cyan-fg">fit</span><span class="ansi-blue-fg">(self, X, y, groups, tune_params, **fit_params)</span>
<span class="ansi-green-intense-fg ansi-bold">    663</span>             ray_kwargs<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#34;local_mode&#34;</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">True</span>
<span class="ansi-green-intense-fg ansi-bold">    664</span>         <span class="ansi-green-fg">with</span> ray_context<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">**</span>ray_kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 665</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_fit<span class="ansi-blue-fg">(</span>X<span class="ansi-blue-fg">,</span> y<span class="ansi-blue-fg">,</span> groups<span class="ansi-blue-fg">,</span> tune_params<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>fit_params<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    666</span> 
<span class="ansi-green-intense-fg ansi-bold">    667</span>     <span class="ansi-green-fg">def</span> score<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> X<span class="ansi-blue-fg">,</span> y<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/tune_sklearn/tune_basesearch.py</span> in <span class="ansi-cyan-fg">_fit</span><span class="ansi-blue-fg">(self, X, y, groups, tune_params, **fit_params)</span>
<span class="ansi-green-intense-fg ansi-bold">    570</span>         analysis <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_tune_run<span class="ansi-blue-fg">(</span>config<span class="ansi-blue-fg">,</span> resources_per_trial<span class="ansi-blue-fg">,</span> tune_params<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    571</span> 
<span class="ansi-green-fg">--&gt; 572</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>cv_results_ <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_format_results<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>n_splits<span class="ansi-blue-fg">,</span> analysis<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    573</span> 
<span class="ansi-green-intense-fg ansi-bold">    574</span>         metric <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_metric_name

<span class="ansi-green-fg">~/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/tune_sklearn/tune_basesearch.py</span> in <span class="ansi-cyan-fg">_format_results</span><span class="ansi-blue-fg">(self, n_splits, out)</span>
<span class="ansi-green-intense-fg ansi-bold">    877</span> 
<span class="ansi-green-intense-fg ansi-bold">    878</span>         <span class="ansi-green-fg">for</span> name <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>scoring<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 879</span><span class="ansi-red-fg">             _store(
</span><span class="ansi-green-intense-fg ansi-bold">    880</span>                 results<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    881</span>                 <span class="ansi-blue-fg">&#34;test_%s&#34;</span> <span class="ansi-blue-fg">%</span> name<span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">~/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/tune_sklearn/tune_basesearch.py</span> in <span class="ansi-cyan-fg">_store</span><span class="ansi-blue-fg">(results, key_name, array, n_splits, n_candidates, weights, splits, rank)</span>
<span class="ansi-green-intense-fg ansi-bold">    862</span>                                             key_name)] = array[:, split_i]
<span class="ansi-green-intense-fg ansi-bold">    863</span> 
<span class="ansi-green-fg">--&gt; 864</span><span class="ansi-red-fg">             </span>array_means <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>average<span class="ansi-blue-fg">(</span>array<span class="ansi-blue-fg">,</span> axis<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> weights<span class="ansi-blue-fg">=</span>weights<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    865</span>             results<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#34;mean_%s&#34;</span> <span class="ansi-blue-fg">%</span> key_name<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> array_means
<span class="ansi-green-intense-fg ansi-bold">    866</span>             <span class="ansi-red-fg"># Weighted std is not directly available in numpy</span>

<span class="ansi-green-fg">&lt;__array_function__ internals&gt;</span> in <span class="ansi-cyan-fg">average</span><span class="ansi-blue-fg">(*args, **kwargs)</span>

<span class="ansi-green-fg">~/miniconda3/envs/nbdev_env/lib/python3.9/site-packages/numpy/lib/function_base.py</span> in <span class="ansi-cyan-fg">average</span><span class="ansi-blue-fg">(a, axis, weights, returned)</span>
<span class="ansi-green-intense-fg ansi-bold">    379</span>     <span class="ansi-green-fg">if</span> weights <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    380</span>         avg <span class="ansi-blue-fg">=</span> a<span class="ansi-blue-fg">.</span>mean<span class="ansi-blue-fg">(</span>axis<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 381</span><span class="ansi-red-fg">         </span>scl <span class="ansi-blue-fg">=</span> avg<span class="ansi-blue-fg">.</span>dtype<span class="ansi-blue-fg">.</span>type<span class="ansi-blue-fg">(</span>a<span class="ansi-blue-fg">.</span>size<span class="ansi-blue-fg">/</span>avg<span class="ansi-blue-fg">.</span>size<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    382</span>     <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    383</span>         wgt <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>asanyarray<span class="ansi-blue-fg">(</span>weights<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">ZeroDivisionError</span>: division by zero</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you want to customize data and preprocessing steps you can do so by using <a href="/tabular_ml_toolkit/dataframeloader.html#DataFrameLoader"><code>DataFrameLoader</code></a> and <code>PreProessor</code> classes. Please Check other Tutorials and detail documentations for these classes for more options.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Amazing our 5 Fold CV MAE has even reduced further within few minutes of Tuen Grid Search HyperParams tunning!</strong></p>
<p>If we can continue doing hyperparmas tunning, may be we can even do better, You can also try early_stopping, take that as challenge!</p>
<h6 id="Let's-use-our-newly-found-params-for-a-10-k-fold-training-and-test-predictions">Let's use our newly found params for a 10 k-fold training and test predictions<a class="anchor-link" href="#Let's-use-our-newly-found-params-for-a-10-k-fold-training-and-test-predictions"> </a></h6>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Update-PreProcessor-on-tmlt-with-best-params-found-from-tune-grid-search">Update PreProcessor on tmlt with best params found from tune grid search<a class="anchor-link" href="#Update-PreProcessor-on-tmlt-with-best-params-found-from-tune-grid-search"> </a></h5>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pp_params</span> <span class="o">=</span> <span class="n">tmlt</span><span class="o">.</span><span class="n">get_preprocessor_best_params</span><span class="p">(</span><span class="n">tune_search</span><span class="p">)</span>

<span class="c1"># Update pipeline with updated preprocessor</span>
<span class="n">tmlt</span><span class="o">.</span><span class="n">update_preprocessor</span><span class="p">(</span><span class="o">**</span><span class="n">pp_params</span><span class="p">)</span>
<span class="n">tmlt</span><span class="o">.</span><span class="n">spl</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Update-Model-on-tmlt-with-best-params-found-from-tune-grid-search">Update Model on tmlt with best params found from tune grid search<a class="anchor-link" href="#Update-Model-on-tmlt-with-best-params-found-from-tune-grid-search"> </a></h5>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xgb_model_metrics_score</span><span class="p">,</span> <span class="n">xgb_model_test_preds</span> <span class="o">=</span> <span class="n">tmlt</span><span class="o">.</span><span class="n">do_kfold_training</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                                                          <span class="n">metrics</span><span class="o">=</span><span class="n">mean_absolute_error</span><span class="p">,</span>
                                                                          <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="c1"># Check test dataset prediction shape</span>
<span class="nb">print</span><span class="p">(</span><span class="n">xgb_model_test_preds</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Yay, we have much better MAE with 10 K-Fold</strong></p>

</div>
</div>
</div>
</div>
 

