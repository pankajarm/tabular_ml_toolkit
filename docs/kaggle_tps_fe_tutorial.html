---

title: Getting Started Kaggle TPS Challenge with Tabular ML Toolkit


keywords: fastai
sidebar: home_sidebar

summary: "A Tutorial to showcase usage of tabular_ml_toolkit (tmlt) library on Kaggle TPS Challenge Nov 2021."
description: "A Tutorial to showcase usage of tabular_ml_toolkit (tmlt) library on Kaggle TPS Challenge Nov 2021."
nb_path: "kaggle_tps_fe_tutorial.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: kaggle_tps_fe_tutorial.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pip install -U tabular_ml_toolkit</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="How-to-Best-Use-tabular_ml_toolkit">How to Best Use tabular_ml_toolkit<a class="anchor-link" href="#How-to-Best-Use-tabular_ml_toolkit"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Start with your favorite model and then just simply create <strong>tmlt</strong> with one API.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>Here we are using XGBClassifier, on  <a href="https://www.kaggle.com/c/tabular-playground-series-nov-2021/data">Kaggle TPS Challenge (Nov 2021) data</a></em></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">tabular_ml_toolkit.tmlt</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">LinearSVC</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBClassifier</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># for visualizing pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">set_config</span>
<span class="n">set_config</span><span class="p">(</span><span class="n">display</span><span class="o">=</span><span class="s2">&quot;diagram&quot;</span><span class="p">)</span>

<span class="c1"># just to measure fit performance</span>
<span class="kn">import</span> <span class="nn">time</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">accuracy_score</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">DIRECTORY_PATH</span> <span class="o">=</span> <span class="s2">&quot;/Users/pamathur/kaggle_datasets/tps_nov_2021/&quot;</span>
<span class="n">TRAIN_FILE</span> <span class="o">=</span> <span class="s2">&quot;train.csv&quot;</span>
<span class="n">TEST_FILE</span> <span class="o">=</span> <span class="s2">&quot;test.csv&quot;</span>
<span class="n">SAMPLE_SUB_FILE</span> <span class="o">=</span> <span class="s2">&quot;sample_submission.csv&quot;</span>
<span class="n">OUTPUT_PATH</span> <span class="o">=</span> <span class="s2">&quot;kaggle_tps_output/&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># https://www.kaggle.com/maximkazantsev/tps-11-21-eda-xgboost-optuna</span>

<span class="c1"># ALSO TAKE OUT MODIN OR USE SOME FUNCTIONALITY TO USE BOTH</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h6 id="Create-SVM-model">Create SVM model<a class="anchor-link" href="#Create-SVM-model"> </a></h6>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">skl_svm_model</span> <span class="o">=</span> <span class="n">LinearSVC</span><span class="p">(</span><span class="n">tol</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="n">dual</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmlt</span> <span class="o">=</span> <span class="n">TMLT</span><span class="p">()</span><span class="o">.</span><span class="n">prepare_data_for_training</span><span class="p">(</span>
    <span class="n">train_file_path</span><span class="o">=</span> <span class="n">DIRECTORY_PATH</span> <span class="o">+</span> <span class="n">TRAIN_FILE</span><span class="p">,</span>
    <span class="c1">#test_file_path= DIRECTORY_PATH + TEST_FILE,</span>
    <span class="c1">#make sure to use right index and target columns</span>
    <span class="n">idx_col</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span>
    <span class="n">target</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">skl_svm_model</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
    <span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;binary_classification&quot;</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">4000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Create-a-base-xgb-classifier-model-with-your-best-guess-params">Create a base xgb classifier model with your best guess params<a class="anchor-link" href="#Create-a-base-xgb-classifier-model-with-your-best-guess-params"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xgb_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># your best guess params</span>
    <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="s1">&#39;eval_metric&#39;</span><span class="p">:</span><span class="s1">&#39;auc&#39;</span><span class="p">,</span>
    <span class="c1"># must for xgb classifier otherwise warning will be shown</span>
    <span class="s1">&#39;use_label_encoder&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span>
    <span class="c1"># because 42 is the answer for all the randomness of this universe</span>
    <span class="s1">&#39;random_state&#39;</span><span class="p">:</span><span class="mi">42</span><span class="p">,</span>
    <span class="c1">#for GPU</span>
    <span class="c1">#&#39;tree_method&#39;: &#39;gpu_hist&#39;,</span>
    <span class="c1">#&#39;predictor&#39;: &#39;gpu_predictor&#39;,</span>
<span class="p">}</span>

<span class="n">xgb_model</span> <span class="o">=</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="o">**</span><span class="n">xgb_params</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmlt</span> <span class="o">=</span> <span class="n">TMLT</span><span class="p">()</span><span class="o">.</span><span class="n">prepare_data_for_training</span><span class="p">(</span>
    <span class="n">train_file_path</span><span class="o">=</span> <span class="n">DIRECTORY_PATH</span> <span class="o">+</span> <span class="n">TRAIN_FILE</span><span class="p">,</span>
    <span class="c1">#test_file_path= DIRECTORY_PATH + TEST_FILE,</span>
    <span class="c1">#make sure to use right index and target columns</span>
    <span class="n">idx_col</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span>
    <span class="n">target</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">xgb_model</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
    <span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">4000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-23 14:07:20,402 INFO 12 cores found, model and data parallel processing should worked!
UserWarning: Distributing &lt;class &#39;int&#39;&gt; object. This may take some time.
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-cyan-fg">(apply_list_of_funcs pid=19472)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19469)</span> 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-23 14:07:39,201 INFO DataFrame Memory usage decreased to 0.80 Mb (74.4% reduction)
2021-11-23 14:07:39,201 INFO No test_file_path given, so training will continue without it!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-cyan-fg">(apply_func pid=19469)</span> 
<span class="ansi-cyan-fg">(compute_sliced_len pid=19470)</span> 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-23 14:07:49,152 INFO PreProcessing will include target(s) encoding!
2021-11-23 14:07:49,153 INFO categorical columns are None, Preprocessing will done accordingly!
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmlt</span><span class="o">.</span><span class="n">spl</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<style>#sk-ae5d1120-980e-4253-afa3-093df19cbf85 {color: black;background-color: white;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 pre{padding: 0;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 div.sk-toggleable {background-color: white;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 div.sk-estimator:hover {background-color: #d4ebff;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 div.sk-item {z-index: 1;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 div.sk-parallel::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 div.sk-parallel-item {display: flex;flex-direction: column;position: relative;background-color: white;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 div.sk-parallel-item:only-child::after {width: 0;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;position: relative;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 div.sk-label label {font-family: monospace;font-weight: bold;background-color: white;display: inline-block;line-height: 1.2em;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 div.sk-label-container {position: relative;z-index: 2;text-align: center;}#sk-ae5d1120-980e-4253-afa3-093df19cbf85 div.sk-container {display: inline-block;position: relative;}</style><div id="sk-ae5d1120-980e-4253-afa3-093df19cbf85" class"sk-top-container"><div class="sk-container"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="8153eb20-27f2-493d-afac-91098f7cf92a" type="checkbox" ><label class="sk-toggleable__label" for="8153eb20-27f2-493d-afac-91098f7cf92a">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[('preprocessor',
                 ColumnTransformer(transformers=[('num_cols',
                                                  Pipeline(steps=[('imputer',
                                                                   SimpleImputer(strategy='constant')),
                                                                  ('scaler',
                                                                   StandardScaler())]),
                                                  ['f0', 'f1', 'f2', 'f3', 'f4',
                                                   'f5', 'f6', 'f7', 'f8', 'f9',
                                                   'f10', 'f11', 'f12', 'f13',
                                                   'f14', 'f15', 'f16', 'f17',
                                                   'f18', 'f19', 'f20', 'f21',
                                                   'f22', 'f23', 'f24', 'f25',
                                                   'f26', 'f27', 'f28', 'f29', ...])])),
                (...
                               interaction_constraints=None, learning_rate=0.01,
                               max_delta_step=None, max_depth=None,
                               min_child_weight=None, missing=nan,
                               monotone_constraints=None, n_estimators=100,
                               n_jobs=11, num_parallel_tree=None,
                               predictor=None, random_state=42, reg_alpha=None,
                               reg_lambda=None, scale_pos_weight=None,
                               subsample=None, tree_method=None,
                               use_label_encoder=False,
                               validate_parameters=None, verbosity=None))])</pre></div></div></div><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="8f20cc2d-256e-4d34-8e88-a6c512070f2d" type="checkbox" ><label class="sk-toggleable__label" for="8f20cc2d-256e-4d34-8e88-a6c512070f2d">preprocessor: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(transformers=[('num_cols',
                                 Pipeline(steps=[('imputer',
                                                  SimpleImputer(strategy='constant')),
                                                 ('scaler', StandardScaler())]),
                                 ['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6',
                                  'f7', 'f8', 'f9', 'f10', 'f11', 'f12', 'f13',
                                  'f14', 'f15', 'f16', 'f17', 'f18', 'f19',
                                  'f20', 'f21', 'f22', 'f23', 'f24', 'f25',
                                  'f26', 'f27', 'f28', 'f29', ...])])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="a73b5ff0-b7fb-4cbe-8c22-f867294688f2" type="checkbox" ><label class="sk-toggleable__label" for="a73b5ff0-b7fb-4cbe-8c22-f867294688f2">num_cols</label><div class="sk-toggleable__content"><pre>['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9', 'f10', 'f11', 'f12', 'f13', 'f14', 'f15', 'f16', 'f17', 'f18', 'f19', 'f20', 'f21', 'f22', 'f23', 'f24', 'f25', 'f26', 'f27', 'f28', 'f29', 'f30', 'f31', 'f32', 'f33', 'f34', 'f35', 'f36', 'f37', 'f38', 'f39', 'f40', 'f41', 'f42', 'f43', 'f44', 'f45', 'f46', 'f47', 'f48', 'f49', 'f50', 'f51', 'f52', 'f53', 'f54', 'f55', 'f56', 'f57', 'f58', 'f59', 'f60', 'f61', 'f62', 'f63', 'f64', 'f65', 'f66', 'f67', 'f68', 'f69', 'f70', 'f71', 'f72', 'f73', 'f74', 'f75', 'f76', 'f77', 'f78', 'f79', 'f80', 'f81', 'f82', 'f83', 'f84', 'f85', 'f86', 'f87', 'f88', 'f89', 'f90', 'f91', 'f92', 'f93', 'f94', 'f95', 'f96', 'f97', 'f98', 'f99']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="7a1990e5-e74e-4988-9c59-cfa74c5d9e7c" type="checkbox" ><label class="sk-toggleable__label" for="7a1990e5-e74e-4988-9c59-cfa74c5d9e7c">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='constant')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="f0ac3351-b796-4566-b630-9bdcc87288c2" type="checkbox" ><label class="sk-toggleable__label" for="f0ac3351-b796-4566-b630-9bdcc87288c2">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="f3d3cb61-b3ac-4f4a-968e-988db4ae40a1" type="checkbox" ><label class="sk-toggleable__label" for="f3d3cb61-b3ac-4f4a-968e-988db4ae40a1">XGBClassifier</label><div class="sk-toggleable__content"><pre>XGBClassifier(base_score=None, booster=None, colsample_bylevel=None,
              colsample_bynode=None, colsample_bytree=None,
              enable_categorical=False, eval_metric='auc', gamma=None,
              gpu_id=None, importance_type=None, interaction_constraints=None,
              learning_rate=0.01, max_delta_step=None, max_depth=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              n_estimators=100, n_jobs=11, num_parallel_tree=None,
              predictor=None, random_state=42, reg_alpha=None, reg_lambda=None,
              scale_pos_weight=None, subsample=None, tree_method=None,
              use_label_encoder=False, validate_parameters=None,
              verbosity=None)</pre></div></div></div></div></div></div></div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Let's-do-a-quick-round-of-training">Let's do a quick round of training<a class="anchor-link" href="#Let's-do-a-quick-round-of-training"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># print(f&quot;X_train shape is {tmlt.dfl.X_train.shape}&quot; )</span>
<span class="c1"># print(f&quot;X_valid shape is {tmlt.dfl.X_valid.shape}&quot; )</span>
<span class="c1"># print(f&quot;y_train shape is {tmlt.dfl.y_train.shape}&quot;)</span>
<span class="c1"># print(f&quot;y_valid shape is {tmlt.dfl.y_valid.shape}&quot;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># start = time.time()</span>
<span class="c1"># # Now fit</span>
<span class="c1"># tmlt.spl.fit(tmlt.dfl.X_train, tmlt.dfl.y_train)</span>
<span class="c1"># end = time.time()</span>
<span class="c1"># print(&quot;Fit Time:&quot;, end - start)</span>

<span class="c1"># #predict</span>
<span class="c1"># preds = tmlt.spl.predict(tmlt.dfl.X_valid)</span>
<span class="c1"># preds_probs = tmlt.spl.predict_proba(tmlt.dfl.X_valid)[:, 1]</span>

<span class="c1"># # Metrics</span>
<span class="c1"># auc = roc_auc_score(tmlt.dfl.y_valid, preds_probs)</span>
<span class="c1"># acc = accuracy_score(tmlt.dfl.y_valid, preds)</span>

<span class="c1"># print(f&quot;AUC is : {auc} while Accuracy is : {acc} &quot;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Let's-do-Optuna-based-HyperParameter-search-to-get-best-params-for-fit">Let's do Optuna based HyperParameter search to get best params for fit<a class="anchor-link" href="#Let's-do-Optuna-based-HyperParameter-search-to-get-best-params-for-fit"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">study</span> <span class="o">=</span> <span class="n">tmlt</span><span class="o">.</span><span class="n">do_xgb_optuna_optimization</span><span class="p">(</span><span class="n">optuna_db_path</span><span class="o">=</span><span class="n">OUTPUT_PATH</span><span class="p">,</span> <span class="n">opt_timeout</span><span class="o">=</span><span class="mi">360</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-23 14:25:46,244 INFO Optimization Direction is: minimize
<span class="ansi-green-fg">[I 2021-11-23 14:25:46,274]</span> Using an existing study with name &#39;tmlt_autoxgb&#39; instead of creating a new one.
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-cyan-fg">(apply_list_of_funcs pid=19463)</span> 
<span class="ansi-cyan-fg">(compute_sliced_len pid=19464)</span> 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-23 14:25:49,535 INFO Training Started!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-cyan-fg">(apply_list_of_funcs pid=19463)</span> 
[14:25:55] WARNING: /Users/runner/miniforge3/conda-bld/xgboost-split_1634712680264/work/src/learner.cc:576: 
Parameters: { &#34;colsample_bytree&#34;, &#34;max_depth&#34;, &#34;subsample&#34;, &#34;tree_method&#34; } might not be used.

  This could be a false alarm, with some parameters getting used by language bindings but
  then being mistakenly passed down to XGBoost core, or some parameter actually being used
  but getting flagged wrongly here. Please open an issue if you find any such cases.


</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-23 14:26:07,809 INFO Training Ended!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-cyan-fg">(apply_list_of_funcs pid=19471)</span> 
<span class="ansi-cyan-fg">(compute_sliced_len pid=19466)</span> 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-23 14:26:29,793 INFO log_loss: 0.6051906617963687
2021-11-23 14:26:29,794 INFO roc_auc_score: 0.7158958927251612
2021-11-23 14:26:29,794 INFO accuracy_score: 0.695
2021-11-23 14:26:29,795 INFO f1_score: 0.5836177474402731
2021-11-23 14:26:29,796 INFO precision_score: 0.6151079136690647
2021-11-23 14:26:29,797 INFO recall_score: 0.5551948051948052
<span class="ansi-green-fg">[I 2021-11-23 14:26:29,834]</span> Trial 4 finished with value: 0.6051906617963687 and parameters: {&#39;learning_rate&#39;: 0.07778202222863026, &#39;n_estimators&#39;: 20000, &#39;reg_lambda&#39;: 1.1572194721196033e-05, &#39;reg_alpha&#39;: 3.079971779735798e-08, &#39;subsample&#39;: 0.8566092401661841, &#39;colsample_bytree&#39;: 0.7338078050434531, &#39;max_depth&#39;: 1, &#39;tree_method&#39;: &#39;exact&#39;, &#39;booster&#39;: &#39;gblinear&#39;}. Best is trial 3 with value: 0.6051832608412951.
2021-11-23 14:26:33,655 INFO Training Started!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-cyan-fg">(apply_list_of_funcs pid=19470)</span> 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-23 14:26:56,977 INFO Training Ended!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-cyan-fg">(apply_list_of_funcs pid=19467)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19466)</span> 
<span class="ansi-cyan-fg">(apply_func pid=19463)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19470)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19474)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19467)</span> 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-23 14:27:18,824 INFO log_loss: 1.3733108584548672
2021-11-23 14:27:18,826 INFO roc_auc_score: 0.600121423292155
2021-11-23 14:27:18,826 INFO accuracy_score: 0.59375
2021-11-23 14:27:18,827 INFO f1_score: 0.4574290484140234
2021-11-23 14:27:18,828 INFO precision_score: 0.47079037800687284
2021-11-23 14:27:18,828 INFO recall_score: 0.4448051948051948
<span class="ansi-green-fg">[I 2021-11-23 14:27:18,860]</span> Trial 5 finished with value: 1.3733108584548672 and parameters: {&#39;learning_rate&#39;: 0.14680037130381238, &#39;n_estimators&#39;: 15000, &#39;reg_lambda&#39;: 4.211629467291321, &#39;reg_alpha&#39;: 5.624849648423015e-07, &#39;subsample&#39;: 0.11905642392373826, &#39;colsample_bytree&#39;: 0.7166667785774565, &#39;max_depth&#39;: 2, &#39;tree_method&#39;: &#39;hist&#39;, &#39;booster&#39;: &#39;gbtree&#39;, &#39;gamma&#39;: 2.401734572428494e-07, &#39;grow_policy&#39;: &#39;depthwise&#39;}. Best is trial 3 with value: 0.6051832608412951.
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-cyan-fg">(compute_sliced_len pid=19465)</span> 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-23 14:27:22,683 INFO Training Started!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-cyan-fg">(compute_sliced_len pid=19465)</span> 
<span class="ansi-cyan-fg">(compute_sliced_len pid=19472)</span> 
<span class="ansi-cyan-fg">(apply_func pid=19473)</span> 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-23 14:27:50,993 INFO Training Ended!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-cyan-fg">(apply_list_of_funcs pid=19473)</span> 
<span class="ansi-cyan-fg">(compute_sliced_len pid=19472)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19467)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19470)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19469)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19463)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19467)</span> 
<span class="ansi-cyan-fg">(compute_sliced_len pid=19467)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19473)</span> 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-23 14:28:12,915 INFO log_loss: 0.7951592802736559
2021-11-23 14:28:12,916 INFO roc_auc_score: 0.6458663287931581
2021-11-23 14:28:12,916 INFO accuracy_score: 0.63875
2021-11-23 14:28:12,917 INFO f1_score: 0.5025817555938038
2021-11-23 14:28:12,918 INFO precision_score: 0.5347985347985348
2021-11-23 14:28:12,919 INFO recall_score: 0.474025974025974
<span class="ansi-green-fg">[I 2021-11-23 14:28:12,956]</span> Trial 6 finished with value: 0.7951592802736559 and parameters: {&#39;learning_rate&#39;: 0.020919490032178578, &#39;n_estimators&#39;: 7000, &#39;reg_lambda&#39;: 1.0191685617159378e-06, &#39;reg_alpha&#39;: 2.7618753046849175e-08, &#39;subsample&#39;: 0.5364273278094787, &#39;colsample_bytree&#39;: 0.5406269791805867, &#39;max_depth&#39;: 3, &#39;tree_method&#39;: &#39;approx&#39;, &#39;booster&#39;: &#39;gbtree&#39;, &#39;gamma&#39;: 4.48740453005513e-06, &#39;grow_policy&#39;: &#39;depthwise&#39;}. Best is trial 3 with value: 0.6051832608412951.
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-cyan-fg">(compute_sliced_len pid=19466)</span> 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-23 14:28:16,633 INFO Training Started!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-cyan-fg">(apply_list_of_funcs pid=19464)</span> 
[14:28:21] WARNING: /Users/runner/miniforge3/conda-bld/xgboost-split_1634712680264/work/src/learner.cc:576: 
Parameters: { &#34;colsample_bytree&#34;, &#34;max_depth&#34;, &#34;subsample&#34;, &#34;tree_method&#34; } might not be used.

  This could be a false alarm, with some parameters getting used by language bindings but
  then being mistakenly passed down to XGBoost core, or some parameter actually being used
  but getting flagged wrongly here. Please open an issue if you find any such cases.


</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-23 14:28:35,484 INFO Training Ended!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-cyan-fg">(apply_list_of_funcs pid=19466)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19473)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19474)</span> 
<span class="ansi-cyan-fg">(compute_sliced_len pid=19467)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19474)</span> 
<span class="ansi-cyan-fg">(compute_sliced_len pid=19467)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19473)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19474)</span> 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-23 14:28:56,523 INFO log_loss: 0.6051877725403756
2021-11-23 14:28:56,524 INFO roc_auc_score: 0.7158958927251612
2021-11-23 14:28:56,525 INFO accuracy_score: 0.695
2021-11-23 14:28:56,526 INFO f1_score: 0.5836177474402731
2021-11-23 14:28:56,527 INFO precision_score: 0.6151079136690647
2021-11-23 14:28:56,527 INFO recall_score: 0.5551948051948052
<span class="ansi-green-fg">[I 2021-11-23 14:28:56,560]</span> Trial 7 finished with value: 0.6051877725403756 and parameters: {&#39;learning_rate&#39;: 0.04988928951526494, &#39;n_estimators&#39;: 20000, &#39;reg_lambda&#39;: 1.7238404326454513e-05, &#39;reg_alpha&#39;: 6.60629606464357e-07, &#39;subsample&#39;: 0.2750714764806063, &#39;colsample_bytree&#39;: 0.325291757151274, &#39;max_depth&#39;: 9, &#39;tree_method&#39;: &#39;exact&#39;, &#39;booster&#39;: &#39;gblinear&#39;}. Best is trial 3 with value: 0.6051832608412951.
2021-11-23 14:29:00,226 INFO Training Started!
2021-11-23 14:29:25,026 INFO Training Ended!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-cyan-fg">(apply_list_of_funcs pid=19472)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19474)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19472)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19470)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19467)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19464)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19468)</span> 
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">study</span><span class="o">.</span><span class="n">best_trial</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="now-update-the-model-with-best-params-from-study-and-then-update-the-sklearn-pipeline-with-new-model">now update the model with best params from study and then update the sklearn pipeline with new model<a class="anchor-link" href="#now-update-the-model-with-best-params-from-study-and-then-update-the-sklearn-pipeline-with-new-model"> </a></h5>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xgb_params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">study</span><span class="o">.</span><span class="n">best_trial</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Final xgb_params:&quot;</span><span class="p">,</span> <span class="n">xgb_params</span><span class="p">)</span>
<span class="n">xgb_model</span> <span class="o">=</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="o">**</span><span class="n">xgb_params</span><span class="p">)</span>
<span class="n">tmlt</span><span class="o">.</span><span class="n">update_model</span><span class="p">(</span><span class="n">xgb_model</span><span class="p">)</span>
<span class="n">tmlt</span><span class="o">.</span><span class="n">spl</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Let's-Use-K-Fold-Training">Let's Use K-Fold Training<a class="anchor-link" href="#Let's-Use-K-Fold-Training"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xgb_model_mean_metrics_results</span><span class="p">,</span> <span class="n">xgb_model_test_preds</span><span class="o">=</span> <span class="n">tmlt</span><span class="o">.</span><span class="n">do_kfold_training</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                                                            <span class="n">test_preds_metric</span><span class="o">=</span><span class="n">roc_auc_score</span><span class="p">)</span>
<span class="k">if</span> <span class="n">xgb_model_test_preds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">xgb_model_test_preds</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-cyan-fg">(apply_list_of_funcs pid=19474)</span> 
[14:10:03] WARNING: /Users/runner/miniforge3/conda-bld/xgboost-split_1634712680264/work/src/learner.cc:576: 
Parameters: { &#34;colsample_bytree&#34;, &#34;max_depth&#34;, &#34;subsample&#34;, &#34;tree_method&#34; } might not be used.

  This could be a false alarm, with some parameters getting used by language bindings but
  then being mistakenly passed down to XGBoost core, or some parameter actually being used
  but getting flagged wrongly here. Please open an issue if you find any such cases.


<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19464)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19463)</span> 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-23 14:10:23,049 INFO fold: 1 log_loss : 0.6039021413773298
2021-11-23 14:10:23,050 INFO fold: 1 roc_auc_score : 0.7272275950999355
2021-11-23 14:10:23,051 INFO fold: 1 accuracy_score : 0.6925
2021-11-23 14:10:23,051 INFO fold: 1 f1_score : 0.5758620689655173
2021-11-23 14:10:23,052 INFO fold: 1 precision_score : 0.668
2021-11-23 14:10:23,053 INFO fold: 1 recall_score : 0.5060606060606061
2021-11-23 14:10:23,054 WARNING Trying to do Test Predictions but No Test Dataset Provided!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[14:10:27] WARNING: /Users/runner/miniforge3/conda-bld/xgboost-split_1634712680264/work/src/learner.cc:576: 
Parameters: { &#34;colsample_bytree&#34;, &#34;max_depth&#34;, &#34;subsample&#34;, &#34;tree_method&#34; } might not be used.

  This could be a false alarm, with some parameters getting used by language bindings but
  then being mistakenly passed down to XGBoost core, or some parameter actually being used
  but getting flagged wrongly here. Please open an issue if you find any such cases.


<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19471)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19472)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19463)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19471)</span> 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-23 14:10:49,192 INFO fold: 2 log_loss : 0.6287158783921041
2021-11-23 14:10:49,193 INFO fold: 2 roc_auc_score : 0.694635718891038
2021-11-23 14:10:49,194 INFO fold: 2 accuracy_score : 0.6825
2021-11-23 14:10:49,195 INFO fold: 2 f1_score : 0.5876623376623378
2021-11-23 14:10:49,196 INFO fold: 2 precision_score : 0.6328671328671329
2021-11-23 14:10:49,197 INFO fold: 2 recall_score : 0.5484848484848485
2021-11-23 14:10:49,198 WARNING Trying to do Test Predictions but No Test Dataset Provided!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[14:10:54] WARNING: /Users/runner/miniforge3/conda-bld/xgboost-split_1634712680264/work/src/learner.cc:576: 
Parameters: { &#34;colsample_bytree&#34;, &#34;max_depth&#34;, &#34;subsample&#34;, &#34;tree_method&#34; } might not be used.

  This could be a false alarm, with some parameters getting used by language bindings but
  then being mistakenly passed down to XGBoost core, or some parameter actually being used
  but getting flagged wrongly here. Please open an issue if you find any such cases.


<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19472)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19463)</span> 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-23 14:11:12,677 INFO fold: 3 log_loss : 0.65383338053427
2021-11-23 14:11:12,678 INFO fold: 3 roc_auc_score : 0.6620309477756288
2021-11-23 14:11:12,679 INFO fold: 3 accuracy_score : 0.6425
2021-11-23 14:11:12,680 INFO fold: 3 f1_score : 0.5119453924914675
2021-11-23 14:11:12,680 INFO fold: 3 precision_score : 0.5859375
2021-11-23 14:11:12,681 INFO fold: 3 recall_score : 0.45454545454545453
2021-11-23 14:11:12,682 WARNING Trying to do Test Predictions but No Test Dataset Provided!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[14:11:17] WARNING: /Users/runner/miniforge3/conda-bld/xgboost-split_1634712680264/work/src/learner.cc:576: 
Parameters: { &#34;colsample_bytree&#34;, &#34;max_depth&#34;, &#34;subsample&#34;, &#34;tree_method&#34; } might not be used.

  This could be a false alarm, with some parameters getting used by language bindings but
  then being mistakenly passed down to XGBoost core, or some parameter actually being used
  but getting flagged wrongly here. Please open an issue if you find any such cases.


<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19471)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19463)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19465)</span> 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-23 14:11:34,620 INFO fold: 4 log_loss : 0.6231675453111529
2021-11-23 14:11:34,621 INFO fold: 4 roc_auc_score : 0.7080308427650268
2021-11-23 14:11:34,621 INFO fold: 4 accuracy_score : 0.69125
2021-11-23 14:11:34,622 INFO fold: 4 f1_score : 0.5957446808510638
2021-11-23 14:11:34,623 INFO fold: 4 precision_score : 0.65
2021-11-23 14:11:34,624 INFO fold: 4 recall_score : 0.5498489425981873
2021-11-23 14:11:34,625 WARNING Trying to do Test Predictions but No Test Dataset Provided!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[14:11:39] WARNING: /Users/runner/miniforge3/conda-bld/xgboost-split_1634712680264/work/src/learner.cc:576: 
Parameters: { &#34;colsample_bytree&#34;, &#34;max_depth&#34;, &#34;subsample&#34;, &#34;tree_method&#34; } might not be used.

  This could be a false alarm, with some parameters getting used by language bindings but
  then being mistakenly passed down to XGBoost core, or some parameter actually being used
  but getting flagged wrongly here. Please open an issue if you find any such cases.


<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19464)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19466)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19468)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19470)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19467)</span> 
<span class="ansi-cyan-fg">(apply_list_of_funcs pid=19473)</span> 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-11-23 14:11:58,562 INFO fold: 5 log_loss : 0.6006386911938898
2021-11-23 14:11:58,563 INFO fold: 5 roc_auc_score : 0.7226470152474571
2021-11-23 14:11:58,564 INFO fold: 5 accuracy_score : 0.6775
2021-11-23 14:11:58,565 INFO fold: 5 f1_score : 0.568561872909699
2021-11-23 14:11:58,565 INFO fold: 5 precision_score : 0.6367041198501873
2021-11-23 14:11:58,566 INFO fold: 5 recall_score : 0.513595166163142
2021-11-23 14:11:58,567 WARNING Trying to do Test Predictions but No Test Dataset Provided!
2021-11-23 14:11:58,568 INFO  Mean Metrics Results from all Folds are: {&#39;log_loss&#39;: 0.6220515273617493, &#39;roc_auc_score&#39;: 0.7029144239558172, &#39;accuracy_score&#39;: 0.6772500000000001, &#39;f1_score&#39;: 0.5679552705760171, &#39;precision_score&#39;: 0.634701750543464, &#39;recall_score&#39;: 0.5145070035704478}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-cyan-fg">(apply_list_of_funcs pid=19464)</span> 
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># final_preds = ((0.45 * sci_model_preds) + (0.55* xgb_model_test_preds)) / 2</span>
<span class="c1"># print(final_preds.shape)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Create-Kaggle-Predictions">Create Kaggle Predictions<a class="anchor-link" href="#Create-Kaggle-Predictions"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># sub[&#39;target&#39;] = final_preds</span>
<span class="c1"># sub.to_csv(&#39;submission.csv&#39;, index=False)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

