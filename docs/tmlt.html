---

title: Training Pipeline


keywords: fastai
sidebar: home_sidebar

summary: "An API to create super fast training pipeline for machine learning models based on tabular or strucuture data"
description: "An API to create super fast training pipeline for machine learning models based on tabular or strucuture data"
nb_path: "02_tmlt.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 02_tmlt.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/pankajmathur/anaconda3/envs/nbdev_env/lib/python3.9/site-packages/redis/connection.py:77: UserWarning: redis-py works best with hiredis. Please consider installing
  warnings.warn(msg)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TMLT" class="doc_header"><code>class</code> <code>TMLT</code><a href="https://github.com/psmathur/tabular_ml_toolkit/tree/master/tabular_ml_toolkit/tmlt.py#L41" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TMLT</code>()</p>
</blockquote>
<p>Represent Tabular ML Toolkit class</p>
<p>Attributes:</p>
<p>dfl: A DataFrameLoader instance</p>
<p>pp: A PreProcessor instance</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="TMLT.prepare_data" class="doc_header"><code>TMLT.prepare_data</code><a href="https://github.com/psmathur/tabular_ml_toolkit/tree/master/tabular_ml_toolkit/tmlt.py#L70" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>TMLT.prepare_data</code>(<strong><code>train_file_path</code></strong>:<code>str</code>, <strong><code>problem_type</code></strong>:<code>str</code>, <strong><code>idx_col</code></strong>:<code>str</code>, <strong><code>target</code></strong>:<code>str</code>, <strong><code>random_state</code></strong>:<code>int</code>, <strong><code>test_file_path</code></strong>:<code>str</code>=<em><code>None</code></em>, <strong><code>nrows</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="TMLT.do_xgb_optuna_optimization" class="doc_header"><code>TMLT.do_xgb_optuna_optimization</code><a href="https://github.com/psmathur/tabular_ml_toolkit/tree/master/tabular_ml_toolkit/tmlt.py#L427" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>TMLT.do_xgb_optuna_optimization</code>(<strong><code>optuna_db_path</code></strong>:<code>str</code>, <strong><code>use_gpu</code></strong>=<em><code>False</code></em>, <strong><code>opt_trials</code></strong>=<em><code>100</code></em>, <strong><code>opt_timeout</code></strong>=<em><code>360</code></em>)</p>
</blockquote>
<p>This methods returns and do optuna bases study optimization for hyperparmaeter search
optuna_db_path is output directory you want to use for storing sql db used for optuna
use_gpu=False by default, make it True if running on gpu machine
opt_trials=100 by default, change it based upon need
opt_timeout=360 by default, timeout value in seconds</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<!-- 
run script to update all files

make pypi

reconnect and reinstall tmlt on google colab, restart colab
use ensembled oof model code from this notebook and add it to google colab
make sure to comment out nrows=4000
let it run and wait
get submissions and download it
upload it to kaggle to see results
 -->
</div>
</div>
</div>
</div>
 

